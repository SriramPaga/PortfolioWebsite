import{r as D,j as $,p as at}from"./index-B9Apy8la.js";import{t as Wn,v as Vt,w as Lr,x as ar,b as Dt,y as Vn,z as At,D as Ur,A as ir,E as Ke,G as et,C as Ue,J as zn,K as qn,N as $n,h as ct,Q as Oe,V as Or,i as st,j as ee,X as es,e as ts,O as Jr,Y as rs,Z as ns,$ as Mt,a0 as ss,L as Se,a1 as Pr,a2 as zt,a3 as as,a4 as Pt,a5 as is,a6 as Nr,a7 as os,k as kr,a8 as cs,a9 as ls,aa as us,ab as As,ac as hs,ad as Nt,ae as ds,af as Ft,ag as Kr,ah as Bs,ai as fs,aj as ms,ak as Qr,al as It,am as qt,an as ps,ao as Cs,ap as gs,aq as Qe,ar as vs,as as Es,F as Ms,at as Fs,T as Xe,au as Ir,av as Rr,aw as Tr,B as or,c as Xr,ax as Is,ay as Zr,H as Ie,n as Ze,az as lt,aA as Tt,aB as Rs,U as Ts,aC as Ut,_ as qe,u as Re,o as Ot,p as jr,P as cr,W as ht,aD as Lt,aE as Ds,aF as Gs,aG as $t,aH as ys,aI as bs,aJ as ws,aK as xs,aL as er,aM as Ss,aN as Dr,aO as Hs,aP as _s,aQ as Ls,aR as Us,aS as Os,aT as Js,q as Ps,aU as Yr,aV as Gr,M as Ns,aW as ks,r as lr}from"./react-three-fiber.esm-BIDKjGps.js";import{O as ur}from"./OrbitControls-Dw08WTMz.js";function yr(A,e){if(e===Wn)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),A;if(e===Vt||e===Lr){let t=A.getIndex();if(t===null){const a=[],u=A.getAttribute("position");if(u!==void 0){for(let o=0;o<u.count;o++)a.push(o);A.setIndex(a),t=A.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),A}const n=t.count-2,r=[];if(t)if(e===Vt)for(let a=1;a<=n;a++)r.push(t.getX(0)),r.push(t.getX(a)),r.push(t.getX(a+1));else for(let a=0;a<n;a++)a%2===0?(r.push(t.getX(a)),r.push(t.getX(a+1)),r.push(t.getX(a+2))):(r.push(t.getX(a+2)),r.push(t.getX(a+1)),r.push(t.getX(a)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=A.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),A}const Ks=parseInt(ar.replace(/\D+/g,""));var xe=Uint8Array,$e=Uint16Array,tr=Uint32Array,Wr=new xe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Vr=new xe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qs=new xe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),zr=function(A,e){for(var t=new $e(31),n=0;n<31;++n)t[n]=e+=1<<A[n-1];for(var r=new tr(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},qr=zr(Wr,2),$r=qr[0],Xs=qr[1];$r[28]=258,Xs[258]=28;var Zs=zr(Vr,0),js=Zs[0],rr=new $e(32768);for(var le=0;le<32768;++le){var Ve=(le&43690)>>>1|(le&21845)<<1;Ve=(Ve&52428)>>>2|(Ve&13107)<<2,Ve=(Ve&61680)>>>4|(Ve&3855)<<4,rr[le]=((Ve&65280)>>>8|(Ve&255)<<8)>>>1}var Rt=function(A,e,t){for(var n=A.length,r=0,s=new $e(e);r<n;++r)++s[A[r]-1];var a=new $e(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var u;if(t){u=new $e(1<<e);var o=15-e;for(r=0;r<n;++r)if(A[r])for(var c=r<<4|A[r],h=e-A[r],d=a[A[r]-1]++<<h,B=d|(1<<h)-1;d<=B;++d)u[rr[d]>>>o]=c}else for(u=new $e(n),r=0;r<n;++r)A[r]&&(u[r]=rr[a[A[r]-1]++]>>>15-A[r]);return u},Gt=new xe(288);for(var le=0;le<144;++le)Gt[le]=8;for(var le=144;le<256;++le)Gt[le]=9;for(var le=256;le<280;++le)Gt[le]=7;for(var le=280;le<288;++le)Gt[le]=8;var en=new xe(32);for(var le=0;le<32;++le)en[le]=5;var Ys=Rt(Gt,9,1),Ws=Rt(en,5,1),kt=function(A){for(var e=A[0],t=1;t<A.length;++t)A[t]>e&&(e=A[t]);return e},He=function(A,e,t){var n=e/8|0;return(A[n]|A[n+1]<<8)>>(e&7)&t},Kt=function(A,e){var t=e/8|0;return(A[t]|A[t+1]<<8|A[t+2]<<16)>>(e&7)},Vs=function(A){return(A/8|0)+(A&7&&1)},zs=function(A,e,t){(t==null||t>A.length)&&(t=A.length);var n=new(A instanceof $e?$e:A instanceof tr?tr:xe)(t-e);return n.set(A.subarray(e,t)),n},qs=function(A,e,t){var n=A.length;if(!n||t&&!t.l&&n<5)return e||new xe(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new xe(n*3));var a=function(ne){var Je=e.length;if(ne>Je){var Pe=new xe(Math.max(Je*2,ne));Pe.set(e),e=Pe}},u=t.f||0,o=t.p||0,c=t.b||0,h=t.l,d=t.d,B=t.m,m=t.n,g=n*8;do{if(!h){t.f=u=He(A,o,1);var p=He(A,o+1,3);if(o+=3,p)if(p==1)h=Ys,d=Ws,B=9,m=5;else if(p==2){var O=He(A,o,31)+257,x=He(A,o+10,15)+4,y=O+He(A,o+5,31)+1;o+=14;for(var I=new xe(y),S=new xe(19),T=0;T<x;++T)S[Qs[T]]=He(A,o+T*3,7);o+=x*3;for(var b=kt(S),k=(1<<b)-1,j=Rt(S,b,1),T=0;T<y;){var Q=j[He(A,o,k)];o+=Q&15;var v=Q>>>4;if(v<16)I[T++]=v;else{var Y=0,P=0;for(v==16?(P=3+He(A,o,3),o+=2,Y=I[T-1]):v==17?(P=3+He(A,o,7),o+=3):v==18&&(P=11+He(A,o,127),o+=7);P--;)I[T++]=Y}}var q=I.subarray(0,O),X=I.subarray(O);B=kt(q),m=kt(X),h=Rt(q,B,1),d=Rt(X,m,1)}else throw"invalid block type";else{var v=Vs(o)+4,F=A[v-4]|A[v-3]<<8,R=v+F;if(R>n){if(s)throw"unexpected EOF";break}r&&a(c+F),e.set(A.subarray(v,R),c),t.b=c+=F,t.p=o=R*8;continue}if(o>g){if(s)throw"unexpected EOF";break}}r&&a(c+131072);for(var Ce=(1<<B)-1,Te=(1<<m)-1,Ee=o;;Ee=o){var Y=h[Kt(A,o)&Ce],re=Y>>>4;if(o+=Y&15,o>g){if(s)throw"unexpected EOF";break}if(!Y)throw"invalid length/literal";if(re<256)e[c++]=re;else if(re==256){Ee=o,h=null;break}else{var ge=re-254;if(re>264){var T=re-257,ue=Wr[T];ge=He(A,o,(1<<ue)-1)+$r[T],o+=ue}var fe=d[Kt(A,o)&Te],_e=fe>>>4;if(!fe)throw"invalid distance";o+=fe&15;var X=js[_e];if(_e>3){var ue=Vr[_e];X+=Kt(A,o)&(1<<ue)-1,o+=ue}if(o>g){if(s)throw"unexpected EOF";break}r&&a(c+131072);for(var dt=c+ge;c<dt;c+=4)e[c]=e[c-X],e[c+1]=e[c+1-X],e[c+2]=e[c+2-X],e[c+3]=e[c+3-X];c=dt}}t.l=h,t.p=Ee,t.b=c,h&&(u=1,t.m=B,t.d=d,t.n=m)}while(!u);return c==e.length?e:zs(e,0,c)},$s=new xe(0),ea=function(A){if((A[0]&15)!=8||A[0]>>>4>7||(A[0]<<8|A[1])%31)throw"invalid zlib data";if(A[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function wt(A,e){return qs((ea(A),A.subarray(2,-4)),e)}var ta=typeof TextDecoder<"u"&&new TextDecoder,ra=0;try{ta.decode($s,{stream:!0}),ra=1}catch{}const na=A=>A&&A.isCubeTexture;class sa extends Dt{constructor(e,t){var n,r;const s=na(e),u=((r=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,o=Math.floor(Math.log2(u)),c=Math.pow(2,o),h=3*Math.max(c,16*7),d=4*c,B=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/h}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${o}.0`],m=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,g=B.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(ar.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,p={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},v=new Vn(1,16),F=new At({uniforms:p,fragmentShader:g,vertexShader:m,side:Ur});super(v,F)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}const nt="srgb",je="srgb-linear",br=3001,aa=3e3;class Ar extends ir{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new ua(t)}),this.register(function(t){return new Aa(t)}),this.register(function(t){return new va(t)}),this.register(function(t){return new Ea(t)}),this.register(function(t){return new Ma(t)}),this.register(function(t){return new da(t)}),this.register(function(t){return new Ba(t)}),this.register(function(t){return new fa(t)}),this.register(function(t){return new ma(t)}),this.register(function(t){return new la(t)}),this.register(function(t){return new pa(t)}),this.register(function(t){return new ha(t)}),this.register(function(t){return new ga(t)}),this.register(function(t){return new Ca(t)}),this.register(function(t){return new oa(t)}),this.register(function(t){return new Fa(t)}),this.register(function(t){return new Ia(t)})}load(e,t,n,r){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const c=Ke.extractUrlBase(e);a=Ke.resolveURL(c,this.path)}else a=Ke.extractUrlBase(e);this.manager.itemStart(e);const u=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},o=new et(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{s.parse(c,a,function(h){t(h),s.manager.itemEnd(e)},u)}catch(h){u(h)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const a={},u={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Ke.decodeText(new Uint8Array(e.slice(0,4)))===tn){try{a[V.KHR_BINARY_GLTF]=new Ra(e)}catch(h){r&&r(h);return}s=JSON.parse(a[V.KHR_BINARY_GLTF].content)}else s=JSON.parse(Ke.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const o=new Oa(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](o);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[h.name]=h,a[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],d=s.extensionsRequired||[];switch(h){case V.KHR_MATERIALS_UNLIT:a[h]=new ca;break;case V.KHR_DRACO_MESH_COMPRESSION:a[h]=new Ta(s,this.dracoLoader);break;case V.KHR_TEXTURE_TRANSFORM:a[h]=new Da;break;case V.KHR_MESH_QUANTIZATION:a[h]=new Ga;break;default:d.indexOf(h)>=0&&u[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}o.setExtensions(a),o.setPlugins(u),o.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function ia(){let A={};return{get:function(e){return A[e]},add:function(e,t){A[e]=t},remove:function(e){delete A[e]},removeAll:function(){A={}}}}const V={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class oa{constructor(e){this.parser=e,this.name=V.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new Ue(16777215);o.color!==void 0&&h.setRGB(o.color[0],o.color[1],o.color[2],je);const d=o.range!==void 0?o.range:0;switch(o.type){case"directional":c=new $n(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new qn(h),c.distance=d;break;case"spot":c=new zn(h),c.distance=d,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,c.angle=o.spot.outerConeAngle,c.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return c.position.set(0,0,0),c.decay=2,ke(c,o),o.intensity!==void 0&&(c.intensity=o.intensity),c.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],u=(s.extensions&&s.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(o){return n._getNodeRef(t.cache,u,o)})}}class ca{constructor(){this.name=V.KHR_MATERIALS_UNLIT}getMaterialType(){return ct}extendParams(e,t,n){const r=[];e.color=new Ue(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],je),e.opacity=a[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,nt))}return Promise.all(r)}}class la{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class ua{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const u=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Or(u,u)}return Promise.all(s)}}class Aa{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class ha{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class da{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ue(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];if(a.sheenColorFactor!==void 0){const u=a.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],je)}return a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,nt)),a.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class Ba{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class fa{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const u=a.attenuationColor||[1,1,1];return t.attenuationColor=new Ue().setRGB(u[0],u[1],u[2],je),Promise.all(s)}}class ma{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class pa{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const u=a.specularColorFactor||[1,1,1];return t.specularColor=new Ue().setRGB(u[0],u[1],u[2],je),a.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,nt)),Promise.all(s)}}class Ca{constructor(e){this.parser=e,this.name=V.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}}class ga{constructor(e){this.parser=e,this.name=V.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Oe}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class va{constructor(e){this.parser=e,this.name=V.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class Ea{constructor(e){this.parser=e,this.name=V.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],u=r.images[a.source];let o=n.textureLoader;if(u.uri){const c=n.options.manager.getHandler(u.uri);c!==null&&(o=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Ma{constructor(e){this.parser=e,this.name=V.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],u=r.images[a.source];let o=n.textureLoader;if(u.uri){const c=n.options.manager.getHandler(u.uri);c!==null&&(o=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Fa{constructor(e){this.name=V.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(u){const o=r.byteOffset||0,c=r.byteLength||0,h=r.count,d=r.byteStride,B=new Uint8Array(u,o,c);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(h,d,B,r.mode,r.filter).then(function(m){return m.buffer}):a.ready.then(function(){const m=new ArrayBuffer(h*d);return a.decodeGltfBuffer(new Uint8Array(m),h,d,B,r.mode,r.filter),m})})}else return null}}class Ia{constructor(e){this.name=V.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==we.TRIANGLES&&c.mode!==we.TRIANGLE_STRIP&&c.mode!==we.TRIANGLE_FAN&&c.mode!==void 0)return null;const a=n.extensions[this.name].attributes,u=[],o={};for(const c in a)u.push(this.parser.getDependency("accessor",a[c]).then(h=>(o[c]=h,o[c])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(c=>{const h=c.pop(),d=h.isGroup?h.children:[h],B=c[0].count,m=[];for(const g of d){const p=new st,v=new ee,F=new It,R=new ee(1,1,1),O=new es(g.geometry,g.material,B);for(let x=0;x<B;x++)o.TRANSLATION&&v.fromBufferAttribute(o.TRANSLATION,x),o.ROTATION&&F.fromBufferAttribute(o.ROTATION,x),o.SCALE&&R.fromBufferAttribute(o.SCALE,x),O.setMatrixAt(x,p.compose(v,F,R));for(const x in o)if(x==="_COLOR_0"){const y=o[x];O.instanceColor=new ts(y.array,y.itemSize,y.normalized)}else x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&g.geometry.setAttribute(x,o[x]);Jr.prototype.copy.call(O,g),this.parser.assignFinalMaterial(O),m.push(O)}return h.isGroup?(h.clear(),h.add(...m),h):m[0]}))}}const tn="glTF",gt=12,wr={JSON:1313821514,BIN:5130562};class Ra{constructor(e){this.name=V.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,gt);if(this.header={magic:Ke.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==tn)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-gt,r=new DataView(e,gt);let s=0;for(;s<n;){const a=r.getUint32(s,!0);s+=4;const u=r.getUint32(s,!0);if(s+=4,u===wr.JSON){const o=new Uint8Array(e,gt+s,a);this.content=Ke.decodeText(o)}else if(u===wr.BIN){const o=gt+s;this.body=e.slice(o,o+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ta{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=V.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,u={},o={},c={};for(const h in a){const d=nr[h]||h.toLowerCase();u[d]=a[h]}for(const h in e.attributes){const d=nr[h]||h.toLowerCase();if(a[h]!==void 0){const B=n.accessors[e.attributes[h]],m=ut[B.componentType];c[d]=m.name,o[d]=B.normalized===!0}}return t.getDependency("bufferView",s).then(function(h){return new Promise(function(d,B){r.decodeDracoFile(h,function(m){for(const g in m.attributes){const p=m.attributes[g],v=o[g];v!==void 0&&(p.normalized=v)}d(m)},u,c,je,B)})})}}class Da{constructor(){this.name=V.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Ga{constructor(){this.name=V.KHR_MESH_QUANTIZATION}}class rn extends Is{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)t[a]=n[s+a];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,u=this.valueSize,o=u*2,c=u*3,h=r-t,d=(n-t)/h,B=d*d,m=B*d,g=e*c,p=g-c,v=-2*m+3*B,F=m-B,R=1-v,O=F-B+d;for(let x=0;x!==u;x++){const y=a[p+x+u],I=a[p+x+o]*h,S=a[g+x+u],T=a[g+x]*h;s[x]=R*y+O*I+v*S+F*T}return s}}const ya=new It;class ba extends rn{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return ya.fromArray(s).normalize().toArray(s),s}}const we={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ut={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},xr={9728:qt,9729:Se,9984:ps,9985:Cs,9986:gs,9987:Pr},Sr={33071:Qe,33648:vs,10497:zt},Qt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nr={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Ks>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ze={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},wa={CUBICSPLINE:void 0,LINEAR:Qr,STEP:Es},Xt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function xa(A){return A.DefaultMaterial===void 0&&(A.DefaultMaterial=new Nr({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ms})),A.DefaultMaterial}function rt(A,e,t){for(const n in t.extensions)A[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function ke(A,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(A.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Sa(A,e,t){let n=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const d=e[c];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(A);const a=[],u=[],o=[];for(let c=0,h=e.length;c<h;c++){const d=e[c];if(n){const B=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):A.attributes.position;a.push(B)}if(r){const B=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):A.attributes.normal;u.push(B)}if(s){const B=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):A.attributes.color;o.push(B)}}return Promise.all([Promise.all(a),Promise.all(u),Promise.all(o)]).then(function(c){const h=c[0],d=c[1],B=c[2];return n&&(A.morphAttributes.position=h),r&&(A.morphAttributes.normal=d),s&&(A.morphAttributes.color=B),A.morphTargetsRelative=!0,A})}function Ha(A,e){if(A.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)A.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(A.morphTargetInfluences.length===t.length){A.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)A.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function _a(A){let e;const t=A.extensions&&A.extensions[V.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Zt(t.attributes):e=A.indices+":"+Zt(A.attributes)+":"+A.mode,A.targets!==void 0)for(let n=0,r=A.targets.length;n<r;n++)e+=":"+Zt(A.targets[n]);return e}function Zt(A){let e="";const t=Object.keys(A).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+A[t[n]]+";";return e}function sr(A){switch(A){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function La(A){return A.search(/\.jpe?g($|\?)/i)>0||A.search(/^data\:image\/jpeg/)===0?"image/jpeg":A.search(/\.webp($|\?)/i)>0||A.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Ua=new st;class Oa{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ia,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new rs(this.options.manager):this.textureLoader=new ns(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new et(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(a){const u={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:n,userData:{}};return rt(s,u,r),ke(u,r),Promise.all(n._invokeAll(function(o){return o.afterRoot&&o.afterRoot(u)})).then(function(){for(const o of u.scenes)o.updateMatrixWorld();e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const a=t[r].joints;for(let u=0,o=a.length;u<o;u++)e[a[u]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(n[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(a,u)=>{const o=this.associations.get(a);o!=null&&this.associations.set(u,o);for(const[c,h]of a.children.entries())s(h,u.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,a){return n.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[V.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){n.load(Ke.resolveURL(t.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const a=Qt[r.type],u=ut[r.componentType],o=r.normalized===!0,c=new u(r.count*a);return Promise.resolve(new Mt(c,a,o))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const u=a[0],o=Qt[r.type],c=ut[r.componentType],h=c.BYTES_PER_ELEMENT,d=h*o,B=r.byteOffset||0,m=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,g=r.normalized===!0;let p,v;if(m&&m!==d){const F=Math.floor(B/m),R="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+F+":"+r.count;let O=t.cache.get(R);O||(p=new c(u,F*m,r.count*m/h),O=new ss(p,m/h),t.cache.add(R,O)),v=new Fs(O,o,B%m/h,g)}else u===null?p=new c(r.count*o):p=new c(u,B,r.count*o),v=new Mt(p,o,g);if(r.sparse!==void 0){const F=Qt.SCALAR,R=ut[r.sparse.indices.componentType],O=r.sparse.indices.byteOffset||0,x=r.sparse.values.byteOffset||0,y=new R(a[1],O,r.sparse.count*F),I=new c(a[2],x,r.sparse.count*o);u!==null&&(v=new Mt(v.array.slice(),v.itemSize,v.normalized));for(let S=0,T=y.length;S<T;S++){const b=y[S];if(v.setX(b,I[S*o]),o>=2&&v.setY(b,I[S*o+1]),o>=3&&v.setZ(b,I[S*o+2]),o>=4&&v.setW(b,I[S*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,a=t.images[s];let u=this.textureLoader;if(a.uri){const o=n.manager.getHandler(a.uri);o!==null&&(u=o)}return this.loadTextureImage(e,s,u)}loadTextureImage(e,t,n){const r=this,s=this.json,a=s.textures[e],u=s.images[t],o=(u.uri||u.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const c=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=a.name||u.name||"",h.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(h.name=u.uri);const B=(s.samplers||{})[a.sampler]||{};return h.magFilter=xr[B.magFilter]||Se,h.minFilter=xr[B.minFilter]||Pr,h.wrapS=Sr[B.wrapS]||zt,h.wrapT=Sr[B.wrapT]||zt,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[o]=c,c}loadImageSource(e,t){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const a=r.images[e],u=self.URL||self.webkitURL;let o=a.uri||"",c=!1;if(a.bufferView!==void 0)o=n.getDependency("bufferView",a.bufferView).then(function(d){c=!0;const B=new Blob([d],{type:a.mimeType});return o=u.createObjectURL(B),o});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(o).then(function(d){return new Promise(function(B,m){let g=B;t.isImageBitmapLoader===!0&&(g=function(p){const v=new Xe(p);v.needsUpdate=!0,B(v)}),t.load(Ke.resolveURL(d,s.path),g,void 0,m)})}).then(function(d){return c===!0&&u.revokeObjectURL(o),ke(d,a),d.userData.mimeType=a.mimeType||La(a.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),d});return this.sourceCache[e]=h,h}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(a){if(!a)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(a=a.clone(),a.channel=n.texCoord),s.extensions[V.KHR_TEXTURE_TRANSFORM]){const u=n.extensions!==void 0?n.extensions[V.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const o=s.associations.get(a);a=s.extensions[V.KHR_TEXTURE_TRANSFORM].extendTexture(a,u),s.associations.set(a,o)}}return r!==void 0&&(typeof r=="number"&&(r=r===br?nt:je),"colorSpace"in a?a.colorSpace=r:a.encoding=r===nt?br:aa),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let o=this.cache.get(u);o||(o=new as,Pt.prototype.copy.call(o,n),o.color.copy(n.color),o.map=n.map,o.sizeAttenuation=!1,this.cache.add(u,o)),n=o}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let o=this.cache.get(u);o||(o=new is,Pt.prototype.copy.call(o,n),o.color.copy(n.color),o.map=n.map,this.cache.add(u,o)),n=o}if(r||s||a){let u="ClonedMaterial:"+n.uuid+":";r&&(u+="derivative-tangents:"),s&&(u+="vertex-colors:"),a&&(u+="flat-shading:");let o=this.cache.get(u);o||(o=n.clone(),s&&(o.vertexColors=!0),a&&(o.flatShading=!0),r&&(o.normalScale&&(o.normalScale.y*=-1),o.clearcoatNormalScale&&(o.clearcoatNormalScale.y*=-1)),this.cache.add(u,o),this.associations.set(o,this.associations.get(n))),n=o}e.material=n}getMaterialType(){return Nr}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let a;const u={},o=s.extensions||{},c=[];if(o[V.KHR_MATERIALS_UNLIT]){const d=r[V.KHR_MATERIALS_UNLIT];a=d.getMaterialType(),c.push(d.extendParams(u,s,t))}else{const d=s.pbrMetallicRoughness||{};if(u.color=new Ue(1,1,1),u.opacity=1,Array.isArray(d.baseColorFactor)){const B=d.baseColorFactor;u.color.setRGB(B[0],B[1],B[2],je),u.opacity=B[3]}d.baseColorTexture!==void 0&&c.push(t.assignTexture(u,"map",d.baseColorTexture,nt)),u.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,u.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(u,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(u,"roughnessMap",d.metallicRoughnessTexture))),a=this._invokeOne(function(B){return B.getMaterialType&&B.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(B){return B.extendMaterialParams&&B.extendMaterialParams(e,u)})))}s.doubleSided===!0&&(u.side=Ur);const h=s.alphaMode||Xt.OPAQUE;if(h===Xt.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,h===Xt.MASK&&(u.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==ct&&(c.push(t.assignTexture(u,"normalMap",s.normalTexture)),u.normalScale=new Or(1,1),s.normalTexture.scale!==void 0)){const d=s.normalTexture.scale;u.normalScale.set(d,d)}if(s.occlusionTexture!==void 0&&a!==ct&&(c.push(t.assignTexture(u,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==ct){const d=s.emissiveFactor;u.emissive=new Ue().setRGB(d[0],d[1],d[2],je)}return s.emissiveTexture!==void 0&&a!==ct&&c.push(t.assignTexture(u,"emissiveMap",s.emissiveTexture,nt)),Promise.all(c).then(function(){const d=new a(u);return s.name&&(d.name=s.name),ke(d,s),t.associations.set(d,{materials:e}),s.extensions&&rt(r,d,s),d})}createUniqueName(e){const t=os.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(u){return n[V.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(o){return Hr(o,u,t)})}const a=[];for(let u=0,o=e.length;u<o;u++){const c=e[u],h=_a(c),d=r[h];if(d)a.push(d.promise);else{let B;c.extensions&&c.extensions[V.KHR_DRACO_MESH_COMPRESSION]?B=s(c):B=Hr(new kr,c,t),r[h]={primitive:c,promise:B},a.push(B)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],a=s.primitives,u=[];for(let o=0,c=a.length;o<c;o++){const h=a[o].material===void 0?xa(this.cache):this.getDependency("material",a[o].material);u.push(h)}return u.push(t.loadGeometries(a)),Promise.all(u).then(function(o){const c=o.slice(0,o.length-1),h=o[o.length-1],d=[];for(let m=0,g=h.length;m<g;m++){const p=h[m],v=a[m];let F;const R=c[m];if(v.mode===we.TRIANGLES||v.mode===we.TRIANGLE_STRIP||v.mode===we.TRIANGLE_FAN||v.mode===void 0)F=s.isSkinnedMesh===!0?new cs(p,R):new Dt(p,R),F.isSkinnedMesh===!0&&F.normalizeSkinWeights(),v.mode===we.TRIANGLE_STRIP?F.geometry=yr(F.geometry,Lr):v.mode===we.TRIANGLE_FAN&&(F.geometry=yr(F.geometry,Vt));else if(v.mode===we.LINES)F=new ls(p,R);else if(v.mode===we.LINE_STRIP)F=new us(p,R);else if(v.mode===we.LINE_LOOP)F=new As(p,R);else if(v.mode===we.POINTS)F=new hs(p,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(F.geometry.morphAttributes).length>0&&Ha(F,s),F.name=t.createUniqueName(s.name||"mesh_"+e),ke(F,s),v.extensions&&rt(r,F,v),t.assignFinalMaterial(F),d.push(F)}for(let m=0,g=d.length;m<g;m++)t.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return s.extensions&&rt(r,d[0],s),d[0];const B=new Nt;s.extensions&&rt(r,B,s),t.associations.set(B,{meshes:e});for(let m=0,g=d.length;m<g;m++)B.add(d[m]);return B})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new ds(Ft.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Kr(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ke(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),a=r,u=[],o=[];for(let c=0,h=a.length;c<h;c++){const d=a[c];if(d){u.push(d);const B=new st;s!==null&&B.fromArray(s.array,c*16),o.push(B)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Bs(u,o)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,a=[],u=[],o=[],c=[],h=[];for(let d=0,B=r.channels.length;d<B;d++){const m=r.channels[d],g=r.samplers[m.sampler],p=m.target,v=p.node,F=r.parameters!==void 0?r.parameters[g.input]:g.input,R=r.parameters!==void 0?r.parameters[g.output]:g.output;p.node!==void 0&&(a.push(this.getDependency("node",v)),u.push(this.getDependency("accessor",F)),o.push(this.getDependency("accessor",R)),c.push(g),h.push(p))}return Promise.all([Promise.all(a),Promise.all(u),Promise.all(o),Promise.all(c),Promise.all(h)]).then(function(d){const B=d[0],m=d[1],g=d[2],p=d[3],v=d[4],F=[];for(let R=0,O=B.length;R<O;R++){const x=B[R],y=m[R],I=g[R],S=p[R],T=v[R];if(x===void 0)continue;x.updateMatrix&&x.updateMatrix();const b=n._createAnimationTracks(x,y,I,S,T);if(b)for(let k=0;k<b.length;k++)F.push(b[k])}return new fs(s,void 0,F)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const a=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&a.traverse(function(u){if(u.isMesh)for(let o=0,c=r.weights.length;o<c;o++)u.morphTargetInfluences[o]=r.weights[o]}),a})}loadNode(e){const t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),a=[],u=r.children||[];for(let c=0,h=u.length;c<h;c++)a.push(n.getDependency("node",u[c]));const o=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),o]).then(function(c){const h=c[0],d=c[1],B=c[2];B!==null&&h.traverse(function(m){m.isSkinnedMesh&&m.bind(B,Ua)});for(let m=0,g=d.length;m<g;m++)h.add(d[m]);return h})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],a=s.name?r.createUniqueName(s.name):"",u=[],o=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return o&&u.push(o),s.camera!==void 0&&u.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){u.push(c)}),this.nodeCache[e]=Promise.all(u).then(function(c){let h;if(s.isBone===!0?h=new ms:c.length>1?h=new Nt:c.length===1?h=c[0]:h=new Jr,h!==c[0])for(let d=0,B=c.length;d<B;d++)h.add(c[d]);if(s.name&&(h.userData.name=s.name,h.name=a),ke(h,s),s.extensions&&rt(n,h,s),s.matrix!==void 0){const d=new st;d.fromArray(s.matrix),h.applyMatrix4(d)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new Nt;n.name&&(s.name=r.createUniqueName(n.name)),ke(s,n),n.extensions&&rt(t,s,n);const a=n.nodes||[],u=[];for(let o=0,c=a.length;o<c;o++)u.push(r.getDependency("node",a[o]));return Promise.all(u).then(function(o){for(let h=0,d=o.length;h<d;h++)s.add(o[h]);const c=h=>{const d=new Map;for(const[B,m]of r.associations)(B instanceof Pt||B instanceof Xe)&&d.set(B,m);return h.traverse(B=>{const m=r.associations.get(B);m!=null&&d.set(B,m)}),d};return r.associations=c(s),s})}_createAnimationTracks(e,t,n,r,s){const a=[],u=e.name?e.name:e.uuid,o=[];ze[s.path]===ze.weights?e.traverse(function(B){B.morphTargetInfluences&&o.push(B.name?B.name:B.uuid)}):o.push(u);let c;switch(ze[s.path]){case ze.weights:c=Rr;break;case ze.rotation:c=Tr;break;case ze.position:case ze.scale:c=Ir;break;default:switch(n.itemSize){case 1:c=Rr;break;case 2:case 3:default:c=Ir;break}break}const h=r.interpolation!==void 0?wa[r.interpolation]:Qr,d=this._getArrayFromAccessor(n);for(let B=0,m=o.length;B<m;B++){const g=new c(o[B]+"."+ze[s.path],t.array,d,h);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),a.push(g)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=sr(t.constructor),r=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const r=this instanceof Tr?ba:rn;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Ja(A,e,t){const n=e.attributes,r=new or;if(n.POSITION!==void 0){const u=t.json.accessors[n.POSITION],o=u.min,c=u.max;if(o!==void 0&&c!==void 0){if(r.set(new ee(o[0],o[1],o[2]),new ee(c[0],c[1],c[2])),u.normalized){const h=sr(ut[u.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const u=new ee,o=new ee;for(let c=0,h=s.length;c<h;c++){const d=s[c];if(d.POSITION!==void 0){const B=t.json.accessors[d.POSITION],m=B.min,g=B.max;if(m!==void 0&&g!==void 0){if(o.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),o.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),o.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),B.normalized){const p=sr(ut[B.componentType]);o.multiplyScalar(p)}u.max(o)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(u)}A.boundingBox=r;const a=new Xr;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,A.boundingSphere=a}function Hr(A,e,t){const n=e.attributes,r=[];function s(a,u){return t.getDependency("accessor",a).then(function(o){A.setAttribute(u,o)})}for(const a in n){const u=nr[a]||a.toLowerCase();u in A.attributes||r.push(s(n[a],u))}if(e.indices!==void 0&&!A.index){const a=t.getDependency("accessor",e.indices).then(function(u){A.setIndex(u)});r.push(a)}return ke(A,e),Ja(A,e,t),Promise.all(r).then(function(){return e.targets!==void 0?Sa(A,e.targets,t):A})}const Pa={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Na={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class ka extends Zr{constructor(e){super(e),this.type=Ie}parse(e){const a=function(T,b){switch(T){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(b||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(b||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(b||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(b||""))}},h=`
`,d=function(T,b,k){b=b||1024;let Q=T.pos,Y=-1,P=0,q="",X=String.fromCharCode.apply(null,new Uint16Array(T.subarray(Q,Q+128)));for(;0>(Y=X.indexOf(h))&&P<b&&Q<T.byteLength;)q+=X,P+=X.length,Q+=128,X+=String.fromCharCode.apply(null,new Uint16Array(T.subarray(Q,Q+128)));return-1<Y?(T.pos+=P+Y+1,q+X.slice(0,Y)):!1},B=function(T){const b=/^#\?(\S+)/,k=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Q=/^\s*FORMAT=(\S+)\s*$/,Y=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,P={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let q,X;for((T.pos>=T.byteLength||!(q=d(T)))&&a(1,"no header found"),(X=q.match(b))||a(3,"bad initial token"),P.valid|=1,P.programtype=X[1],P.string+=q+`
`;q=d(T),q!==!1;){if(P.string+=q+`
`,q.charAt(0)==="#"){P.comments+=q+`
`;continue}if((X=q.match(k))&&(P.gamma=parseFloat(X[1])),(X=q.match(j))&&(P.exposure=parseFloat(X[1])),(X=q.match(Q))&&(P.valid|=2,P.format=X[1]),(X=q.match(Y))&&(P.valid|=4,P.height=parseInt(X[1],10),P.width=parseInt(X[2],10)),P.valid&2&&P.valid&4)break}return P.valid&2||a(3,"missing format specifier"),P.valid&4||a(3,"missing image size specifier"),P},m=function(T,b,k){const j=b;if(j<8||j>32767||T[0]!==2||T[1]!==2||T[2]&128)return new Uint8Array(T);j!==(T[2]<<8|T[3])&&a(3,"wrong scanline width");const Q=new Uint8Array(4*b*k);Q.length||a(4,"unable to allocate buffer space");let Y=0,P=0;const q=4*j,X=new Uint8Array(4),Ce=new Uint8Array(q);let Te=k;for(;Te>0&&P<T.byteLength;){P+4>T.byteLength&&a(1),X[0]=T[P++],X[1]=T[P++],X[2]=T[P++],X[3]=T[P++],(X[0]!=2||X[1]!=2||(X[2]<<8|X[3])!=j)&&a(3,"bad rgbe scanline format");let Ee=0,re;for(;Ee<q&&P<T.byteLength;){re=T[P++];const ue=re>128;if(ue&&(re-=128),(re===0||Ee+re>q)&&a(3,"bad scanline data"),ue){const fe=T[P++];for(let _e=0;_e<re;_e++)Ce[Ee++]=fe}else Ce.set(T.subarray(P,P+re),Ee),Ee+=re,P+=re}const ge=j;for(let ue=0;ue<ge;ue++){let fe=0;Q[Y]=Ce[ue+fe],fe+=j,Q[Y+1]=Ce[ue+fe],fe+=j,Q[Y+2]=Ce[ue+fe],fe+=j,Q[Y+3]=Ce[ue+fe],Y+=4}Te--}return Q},g=function(T,b,k,j){const Q=T[b+3],Y=Math.pow(2,Q-128)/255;k[j+0]=T[b+0]*Y,k[j+1]=T[b+1]*Y,k[j+2]=T[b+2]*Y,k[j+3]=1},p=function(T,b,k,j){const Q=T[b+3],Y=Math.pow(2,Q-128)/255;k[j+0]=lt.toHalfFloat(Math.min(T[b+0]*Y,65504)),k[j+1]=lt.toHalfFloat(Math.min(T[b+1]*Y,65504)),k[j+2]=lt.toHalfFloat(Math.min(T[b+2]*Y,65504)),k[j+3]=lt.toHalfFloat(1)},v=new Uint8Array(e);v.pos=0;const F=B(v),R=F.width,O=F.height,x=m(v.subarray(v.pos),R,O);let y,I,S;switch(this.type){case Ze:S=x.length/4;const T=new Float32Array(S*4);for(let k=0;k<S;k++)g(x,k*4,T,k*4);y=T,I=Ze;break;case Ie:S=x.length/4;const b=new Uint16Array(S*4);for(let k=0;k<S;k++)p(x,k*4,b,k*4);y=b,I=Ie;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:R,height:O,data:y,header:F.string,gamma:F.gamma,exposure:F.exposure,type:I}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(a,u){switch(a.type){case Ze:case Ie:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Se,a.magFilter=Se,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,u)}return super.load(e,s,n,r)}}const vt="colorSpace"in new Xe;class Ka extends Zr{constructor(e){super(e),this.type=Ie}parse(e){const b=Math.pow(2.7182818,2.2);function k(i,l){for(var f=0,C=0;C<65536;++C)(C==0||i[C>>3]&1<<(C&7))&&(l[f++]=C);for(var E=f-1;f<65536;)l[f++]=0;return E}function j(i){for(var l=0;l<16384;l++)i[l]={},i[l].len=0,i[l].lit=0,i[l].p=null}const Q={l:0,c:0,lc:0};function Y(i,l,f,C,E){for(;f<i;)l=l<<8|Mr(C,E),f+=8;f-=i,Q.l=l>>f&(1<<i)-1,Q.c=l,Q.lc=f}const P=new Array(59);function q(i){for(var l=0;l<=58;++l)P[l]=0;for(var l=0;l<65537;++l)P[i[l]]+=1;for(var f=0,l=58;l>0;--l){var C=f+P[l]>>1;P[l]=f,f=C}for(var l=0;l<65537;++l){var E=i[l];E>0&&(i[l]=E|P[E]++<<6)}}function X(i,l,f,C,E,M,w){for(var G=f,L=0,_=0;E<=M;E++){if(G.value-f.value>C)return!1;Y(6,L,_,i,G);var U=Q.l;if(L=Q.c,_=Q.lc,w[E]=U,U==63){if(G.value-f.value>C)throw"Something wrong with hufUnpackEncTable";Y(8,L,_,i,G);var H=Q.l+6;if(L=Q.c,_=Q.lc,E+H>M+1)throw"Something wrong with hufUnpackEncTable";for(;H--;)w[E++]=0;E--}else if(U>=59){var H=U-59+2;if(E+H>M+1)throw"Something wrong with hufUnpackEncTable";for(;H--;)w[E++]=0;E--}}q(w)}function Ce(i){return i&63}function Te(i){return i>>6}function Ee(i,l,f,C){for(;l<=f;l++){var E=Te(i[l]),M=Ce(i[l]);if(E>>M)throw"Invalid table entry";if(M>14){var w=C[E>>M-14];if(w.len)throw"Invalid table entry";if(w.lit++,w.p){var G=w.p;w.p=new Array(w.lit);for(var L=0;L<w.lit-1;++L)w.p[L]=G[L]}else w.p=new Array(1);w.p[w.lit-1]=l}else if(M)for(var _=0,L=1<<14-M;L>0;L--){var w=C[(E<<14-M)+_];if(w.len||w.p)throw"Invalid table entry";w.len=M,w.lit=l,_++}}return!0}const re={c:0,lc:0};function ge(i,l,f,C){i=i<<8|Mr(f,C),l+=8,re.c=i,re.lc=l}const ue={c:0,lc:0};function fe(i,l,f,C,E,M,w,G,L,_){if(i==l){C<8&&(ge(f,C,E,w),f=re.c,C=re.lc),C-=8;var U=f>>C,U=new Uint8Array([U])[0];if(L.value+U>_)return!1;for(var H=G[L.value-1];U-- >0;)G[L.value++]=H}else if(L.value<_)G[L.value++]=i;else return!1;ue.c=f,ue.lc=C}function _e(i){return i&65535}function dt(i){var l=_e(i);return l>32767?l-65536:l}const ne={a:0,b:0};function Je(i,l){var f=dt(i),C=dt(l),E=C,M=f+(E&1)+(E>>1),w=M,G=M-E;ne.a=w,ne.b=G}function Pe(i,l){var f=_e(i),C=_e(l),E=f-(C>>1)&65535,M=C+E-32768&65535;ne.a=M,ne.b=E}function gn(i,l,f,C,E,M,w){for(var G=w<16384,L=f>E?E:f,_=1,U;_<=L;)_<<=1;for(_>>=1,U=_,_>>=1;_>=1;){for(var H=0,he=H+M*(E-U),N=M*_,K=M*U,Z=C*_,W=C*U,se,ie,de,ve;H<=he;H+=K){for(var oe=H,Le=H+C*(f-U);oe<=Le;oe+=W){var ce=oe+Z,Be=oe+N,Ne=Be+Z;G?(Je(i[oe+l],i[Be+l]),se=ne.a,de=ne.b,Je(i[ce+l],i[Ne+l]),ie=ne.a,ve=ne.b,Je(se,ie),i[oe+l]=ne.a,i[ce+l]=ne.b,Je(de,ve),i[Be+l]=ne.a,i[Ne+l]=ne.b):(Pe(i[oe+l],i[Be+l]),se=ne.a,de=ne.b,Pe(i[ce+l],i[Ne+l]),ie=ne.a,ve=ne.b,Pe(se,ie),i[oe+l]=ne.a,i[ce+l]=ne.b,Pe(de,ve),i[Be+l]=ne.a,i[Ne+l]=ne.b)}if(f&_){var Be=oe+N;G?Je(i[oe+l],i[Be+l]):Pe(i[oe+l],i[Be+l]),se=ne.a,i[Be+l]=ne.b,i[oe+l]=se}}if(E&_)for(var oe=H,Le=H+C*(f-U);oe<=Le;oe+=W){var ce=oe+Z;G?Je(i[oe+l],i[ce+l]):Pe(i[oe+l],i[ce+l]),se=ne.a,i[ce+l]=ne.b,i[oe+l]=se}U=_,_>>=1}return H}function vn(i,l,f,C,E,M,w,G,L,_){for(var U=0,H=0,he=G,N=Math.trunc(E.value+(M+7)/8);E.value<N;)for(ge(U,H,f,E),U=re.c,H=re.lc;H>=14;){var K=U>>H-14&16383,Z=l[K];if(Z.len)H-=Z.len,fe(Z.lit,w,U,H,f,C,E,L,_,he),U=ue.c,H=ue.lc;else{if(!Z.p)throw"hufDecode issues";var W;for(W=0;W<Z.lit;W++){for(var se=Ce(i[Z.p[W]]);H<se&&E.value<N;)ge(U,H,f,E),U=re.c,H=re.lc;if(H>=se&&Te(i[Z.p[W]])==(U>>H-se&(1<<se)-1)){H-=se,fe(Z.p[W],w,U,H,f,C,E,L,_,he),U=ue.c,H=ue.lc;break}}if(W==Z.lit)throw"hufDecode issues"}}var ie=8-M&7;for(U>>=ie,H-=ie;H>0;){var Z=l[U<<14-H&16383];if(Z.len)H-=Z.len,fe(Z.lit,w,U,H,f,C,E,L,_,he),U=ue.c,H=ue.lc;else throw"hufDecode issues"}return!0}function mr(i,l,f,C,E,M){var w={value:0},G=f.value,L=Me(l,f),_=Me(l,f);f.value+=4;var U=Me(l,f);if(f.value+=4,L<0||L>=65537||_<0||_>=65537)throw"Something wrong with HUF_ENCSIZE";var H=new Array(65537),he=new Array(16384);j(he);var N=C-(f.value-G);if(X(i,l,f,N,L,_,H),U>8*(C-(f.value-G)))throw"Something wrong with hufUncompress";Ee(H,L,_,he),vn(H,he,i,l,f,U,_,M,E,w)}function En(i,l,f){for(var C=0;C<f;++C)l[C]=i[l[C]]}function pr(i){for(var l=1;l<i.length;l++){var f=i[l-1]+i[l]-128;i[l]=f}}function Cr(i,l){for(var f=0,C=Math.floor((i.length+1)/2),E=0,M=i.length-1;!(E>M||(l[E++]=i[f++],E>M));)l[E++]=i[C++]}function gr(i){for(var l=i.byteLength,f=new Array,C=0,E=new DataView(i);l>0;){var M=E.getInt8(C++);if(M<0){var w=-M;l-=w+1;for(var G=0;G<w;G++)f.push(E.getUint8(C++))}else{var w=M;l-=2;for(var L=E.getUint8(C++),G=0;G<w+1;G++)f.push(L)}}return f}function Mn(i,l,f,C,E,M){var ce=new DataView(M.buffer),w=f[i.idx[0]].width,G=f[i.idx[0]].height,L=3,_=Math.floor(w/8),U=Math.ceil(w/8),H=Math.ceil(G/8),he=w-(U-1)*8,N=G-(H-1)*8,K={value:0},Z=new Array(L),W=new Array(L),se=new Array(L),ie=new Array(L),de=new Array(L);for(let ae=0;ae<L;++ae)de[ae]=l[i.idx[ae]],Z[ae]=ae<1?0:Z[ae-1]+U*H,W[ae]=new Float32Array(64),se[ae]=new Uint16Array(64),ie[ae]=new Uint16Array(U*64);for(let ae=0;ae<H;++ae){var ve=8;ae==H-1&&(ve=N);var oe=8;for(let Ae=0;Ae<U;++Ae){Ae==U-1&&(oe=he);for(let te=0;te<L;++te)se[te].fill(0),se[te][0]=E[Z[te]++],Fn(K,C,se[te]),In(se[te],W[te]),Rn(W[te]);Tn(W);for(let te=0;te<L;++te)Dn(W[te],ie[te],Ae*64)}let pe=0;for(let Ae=0;Ae<L;++Ae){const te=f[i.idx[Ae]].type;for(let ye=8*ae;ye<8*ae+ve;++ye){pe=de[Ae][ye];for(let tt=0;tt<_;++tt){const Fe=tt*64+(ye&7)*8;ce.setUint16(pe+0*2*te,ie[Ae][Fe+0],!0),ce.setUint16(pe+1*2*te,ie[Ae][Fe+1],!0),ce.setUint16(pe+2*2*te,ie[Ae][Fe+2],!0),ce.setUint16(pe+3*2*te,ie[Ae][Fe+3],!0),ce.setUint16(pe+4*2*te,ie[Ae][Fe+4],!0),ce.setUint16(pe+5*2*te,ie[Ae][Fe+5],!0),ce.setUint16(pe+6*2*te,ie[Ae][Fe+6],!0),ce.setUint16(pe+7*2*te,ie[Ae][Fe+7],!0),pe+=8*2*te}}if(_!=U)for(let ye=8*ae;ye<8*ae+ve;++ye){const tt=de[Ae][ye]+8*_*2*te,Fe=_*64+(ye&7)*8;for(let We=0;We<oe;++We)ce.setUint16(tt+We*2*te,ie[Ae][Fe+We],!0)}}}for(var Le=new Uint16Array(w),ce=new DataView(M.buffer),Be=0;Be<L;++Be){f[i.idx[Be]].decoded=!0;var Ne=f[i.idx[Be]].type;if(f[Be].type==2)for(var Ct=0;Ct<G;++Ct){const ae=de[Be][Ct];for(var Ge=0;Ge<w;++Ge)Le[Ge]=ce.getUint16(ae+Ge*2*Ne,!0);for(var Ge=0;Ge<w;++Ge)ce.setFloat32(ae+Ge*2*Ne,J(Le[Ge]),!0)}}}function Fn(i,l,f){for(var C,E=1;E<64;)C=l[i.value],C==65280?E=64:C>>8==255?E+=C&255:(f[E]=C,E++),i.value++}function In(i,l){l[0]=J(i[0]),l[1]=J(i[1]),l[2]=J(i[5]),l[3]=J(i[6]),l[4]=J(i[14]),l[5]=J(i[15]),l[6]=J(i[27]),l[7]=J(i[28]),l[8]=J(i[2]),l[9]=J(i[4]),l[10]=J(i[7]),l[11]=J(i[13]),l[12]=J(i[16]),l[13]=J(i[26]),l[14]=J(i[29]),l[15]=J(i[42]),l[16]=J(i[3]),l[17]=J(i[8]),l[18]=J(i[12]),l[19]=J(i[17]),l[20]=J(i[25]),l[21]=J(i[30]),l[22]=J(i[41]),l[23]=J(i[43]),l[24]=J(i[9]),l[25]=J(i[11]),l[26]=J(i[18]),l[27]=J(i[24]),l[28]=J(i[31]),l[29]=J(i[40]),l[30]=J(i[44]),l[31]=J(i[53]),l[32]=J(i[10]),l[33]=J(i[19]),l[34]=J(i[23]),l[35]=J(i[32]),l[36]=J(i[39]),l[37]=J(i[45]),l[38]=J(i[52]),l[39]=J(i[54]),l[40]=J(i[20]),l[41]=J(i[22]),l[42]=J(i[33]),l[43]=J(i[38]),l[44]=J(i[46]),l[45]=J(i[51]),l[46]=J(i[55]),l[47]=J(i[60]),l[48]=J(i[21]),l[49]=J(i[34]),l[50]=J(i[37]),l[51]=J(i[47]),l[52]=J(i[50]),l[53]=J(i[56]),l[54]=J(i[59]),l[55]=J(i[61]),l[56]=J(i[35]),l[57]=J(i[36]),l[58]=J(i[48]),l[59]=J(i[49]),l[60]=J(i[57]),l[61]=J(i[58]),l[62]=J(i[62]),l[63]=J(i[63])}function Rn(i){const l=.5*Math.cos(.7853975),f=.5*Math.cos(3.14159/16),C=.5*Math.cos(3.14159/8),E=.5*Math.cos(3*3.14159/16),M=.5*Math.cos(5*3.14159/16),w=.5*Math.cos(3*3.14159/8),G=.5*Math.cos(7*3.14159/16);for(var L=new Array(4),_=new Array(4),U=new Array(4),H=new Array(4),he=0;he<8;++he){var N=he*8;L[0]=C*i[N+2],L[1]=w*i[N+2],L[2]=C*i[N+6],L[3]=w*i[N+6],_[0]=f*i[N+1]+E*i[N+3]+M*i[N+5]+G*i[N+7],_[1]=E*i[N+1]-G*i[N+3]-f*i[N+5]-M*i[N+7],_[2]=M*i[N+1]-f*i[N+3]+G*i[N+5]+E*i[N+7],_[3]=G*i[N+1]-M*i[N+3]+E*i[N+5]-f*i[N+7],U[0]=l*(i[N+0]+i[N+4]),U[3]=l*(i[N+0]-i[N+4]),U[1]=L[0]+L[3],U[2]=L[1]-L[2],H[0]=U[0]+U[1],H[1]=U[3]+U[2],H[2]=U[3]-U[2],H[3]=U[0]-U[1],i[N+0]=H[0]+_[0],i[N+1]=H[1]+_[1],i[N+2]=H[2]+_[2],i[N+3]=H[3]+_[3],i[N+4]=H[3]-_[3],i[N+5]=H[2]-_[2],i[N+6]=H[1]-_[1],i[N+7]=H[0]-_[0]}for(var K=0;K<8;++K)L[0]=C*i[16+K],L[1]=w*i[16+K],L[2]=C*i[48+K],L[3]=w*i[48+K],_[0]=f*i[8+K]+E*i[24+K]+M*i[40+K]+G*i[56+K],_[1]=E*i[8+K]-G*i[24+K]-f*i[40+K]-M*i[56+K],_[2]=M*i[8+K]-f*i[24+K]+G*i[40+K]+E*i[56+K],_[3]=G*i[8+K]-M*i[24+K]+E*i[40+K]-f*i[56+K],U[0]=l*(i[K]+i[32+K]),U[3]=l*(i[K]-i[32+K]),U[1]=L[0]+L[3],U[2]=L[1]-L[2],H[0]=U[0]+U[1],H[1]=U[3]+U[2],H[2]=U[3]-U[2],H[3]=U[0]-U[1],i[0+K]=H[0]+_[0],i[8+K]=H[1]+_[1],i[16+K]=H[2]+_[2],i[24+K]=H[3]+_[3],i[32+K]=H[3]-_[3],i[40+K]=H[2]-_[2],i[48+K]=H[1]-_[1],i[56+K]=H[0]-_[0]}function Tn(i){for(var l=0;l<64;++l){var f=i[0][l],C=i[1][l],E=i[2][l];i[0][l]=f+1.5747*E,i[1][l]=f-.1873*C-.4682*E,i[2][l]=f+1.8556*C}}function Dn(i,l,f){for(var C=0;C<64;++C)l[f+C]=lt.toHalfFloat(Gn(i[C]))}function Gn(i){return i<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(b,Math.abs(i)-1)}function vr(i){return new DataView(i.array.buffer,i.offset.value,i.size)}function yn(i){var l=i.viewer.buffer.slice(i.offset.value,i.offset.value+i.size),f=new Uint8Array(gr(l)),C=new Uint8Array(f.length);return pr(f),Cr(f,C),new DataView(C.buffer)}function Jt(i){var l=i.array.slice(i.offset.value,i.offset.value+i.size),f=wt(l),C=new Uint8Array(f.length);return pr(f),Cr(f,C),new DataView(C.buffer)}function bn(i){for(var l=i.viewer,f={value:i.offset.value},C=new Uint16Array(i.width*i.scanlineBlockSize*(i.channels*i.type)),E=new Uint8Array(8192),M=0,w=new Array(i.channels),G=0;G<i.channels;G++)w[G]={},w[G].start=M,w[G].end=w[G].start,w[G].nx=i.width,w[G].ny=i.lines,w[G].size=i.type,M+=w[G].nx*w[G].ny*w[G].size;var L=ft(l,f),_=ft(l,f);if(_>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(L<=_)for(var G=0;G<_-L+1;G++)E[G+L]=it(l,f);var U=new Uint16Array(65536),H=k(E,U),he=Me(l,f);mr(i.array,l,f,he,C,M);for(var G=0;G<i.channels;++G)for(var N=w[G],K=0;K<w[G].size;++K)gn(C,N.start+K,N.nx,N.size,N.ny,N.nx*N.size,H);En(U,C,M);for(var Z=0,W=new Uint8Array(C.buffer.byteLength),se=0;se<i.lines;se++)for(var ie=0;ie<i.channels;ie++){var N=w[ie],de=N.nx*N.size,ve=new Uint8Array(C.buffer,N.end*2,de*2);W.set(ve,Z),Z+=de*2,N.end+=de}return new DataView(W.buffer)}function wn(i){var l=i.array.slice(i.offset.value,i.offset.value+i.size),f=wt(l);const C=i.lines*i.channels*i.width,E=i.type==1?new Uint16Array(C):new Uint32Array(C);let M=0,w=0;const G=new Array(4);for(let L=0;L<i.lines;L++)for(let _=0;_<i.channels;_++){let U=0;switch(i.type){case 1:G[0]=M,G[1]=G[0]+i.width,M=G[1]+i.width;for(let H=0;H<i.width;++H){const he=f[G[0]++]<<8|f[G[1]++];U+=he,E[w]=U,w++}break;case 2:G[0]=M,G[1]=G[0]+i.width,G[2]=G[1]+i.width,M=G[2]+i.width;for(let H=0;H<i.width;++H){const he=f[G[0]++]<<24|f[G[1]++]<<16|f[G[2]++]<<8;U+=he,E[w]=U,w++}break}}return new DataView(E.buffer)}function Er(i){var l=i.viewer,f={value:i.offset.value},C=new Uint8Array(i.width*i.lines*(i.channels*i.type*2)),E={version:De(l,f),unknownUncompressedSize:De(l,f),unknownCompressedSize:De(l,f),acCompressedSize:De(l,f),dcCompressedSize:De(l,f),rleCompressedSize:De(l,f),rleUncompressedSize:De(l,f),rleRawSize:De(l,f),totalAcUncompressedCount:De(l,f),totalDcUncompressedCount:De(l,f),acCompression:De(l,f)};if(E.version<2)throw"EXRLoader.parse: "+pt.compression+" version "+E.version+" is unsupported";for(var M=new Array,w=ft(l,f)-2;w>0;){var G=yt(l.buffer,f),L=it(l,f),_=L>>2&3,U=(L>>4)-1,H=new Int8Array([U])[0],he=it(l,f);M.push({name:G,index:H,type:he,compression:_}),w-=G.length+3}for(var N=pt.channels,K=new Array(i.channels),Z=0;Z<i.channels;++Z){var W=K[Z]={},se=N[Z];W.name=se.name,W.compression=0,W.decoded=!1,W.type=se.pixelType,W.pLinear=se.pLinear,W.width=i.width,W.height=i.lines}for(var ie={idx:new Array(3)},de=0;de<i.channels;++de)for(var W=K[de],Z=0;Z<M.length;++Z){var ve=M[Z];W.name==ve.name&&(W.compression=ve.compression,ve.index>=0&&(ie.idx[ve.index]=de),W.offset=de)}if(E.acCompressedSize>0)switch(E.acCompression){case 0:var ce=new Uint16Array(E.totalAcUncompressedCount);mr(i.array,l,f,E.acCompressedSize,ce,E.totalAcUncompressedCount);break;case 1:var oe=i.array.slice(f.value,f.value+E.totalAcUncompressedCount),Le=wt(oe),ce=new Uint16Array(Le.buffer);f.value+=E.totalAcUncompressedCount;break}if(E.dcCompressedSize>0){var Be={array:i.array,offset:f,size:E.dcCompressedSize},Ne=new Uint16Array(Jt(Be).buffer);f.value+=E.dcCompressedSize}if(E.rleRawSize>0){var oe=i.array.slice(f.value,f.value+E.rleCompressedSize),Le=wt(oe),Ct=gr(Le.buffer);f.value+=E.rleCompressedSize}for(var Ge=0,ae=new Array(K.length),Z=0;Z<ae.length;++Z)ae[Z]=new Array;for(var pe=0;pe<i.lines;++pe)for(var Ae=0;Ae<K.length;++Ae)ae[Ae].push(Ge),Ge+=K[Ae].width*i.type*2;Mn(ie,ae,K,ce,Ne,C);for(var Z=0;Z<K.length;++Z){var W=K[Z];if(!W.decoded)switch(W.compression){case 2:for(var te=0,ye=0,pe=0;pe<i.lines;++pe){for(var tt=ae[Z][te],Fe=0;Fe<W.width;++Fe){for(var We=0;We<2*W.type;++We)C[tt++]=Ct[ye+We*W.width*W.height];ye++}te++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(C.buffer)}function yt(i,l){for(var f=new Uint8Array(i),C=0;f[l.value+C]!=0;)C+=1;var E=new TextDecoder().decode(f.slice(l.value,l.value+C));return l.value=l.value+C+1,E}function xn(i,l,f){var C=new TextDecoder().decode(new Uint8Array(i).slice(l.value,l.value+f));return l.value=l.value+f,C}function Sn(i,l){var f=Bt(i,l),C=Me(i,l);return[f,C]}function Hn(i,l){var f=Me(i,l),C=Me(i,l);return[f,C]}function Bt(i,l){var f=i.getInt32(l.value,!0);return l.value=l.value+4,f}function Me(i,l){var f=i.getUint32(l.value,!0);return l.value=l.value+4,f}function Mr(i,l){var f=i[l.value];return l.value=l.value+1,f}function it(i,l){var f=i.getUint8(l.value);return l.value=l.value+1,f}const De=function(i,l){let f;return"getBigInt64"in DataView.prototype?f=Number(i.getBigInt64(l.value,!0)):f=i.getUint32(l.value+4,!0)+Number(i.getUint32(l.value,!0)<<32),l.value+=8,f};function me(i,l){var f=i.getFloat32(l.value,!0);return l.value+=4,f}function _n(i,l){return lt.toHalfFloat(me(i,l))}function J(i){var l=(i&31744)>>10,f=i&1023;return(i>>15?-1:1)*(l?l===31?f?NaN:1/0:Math.pow(2,l-15)*(1+f/1024):6103515625e-14*(f/1024))}function ft(i,l){var f=i.getUint16(l.value,!0);return l.value+=2,f}function Ln(i,l){return J(ft(i,l))}function Un(i,l,f,C){for(var E=f.value,M=[];f.value<E+C-1;){var w=yt(l,f),G=Bt(i,f),L=it(i,f);f.value+=3;var _=Bt(i,f),U=Bt(i,f);M.push({name:w,pixelType:G,pLinear:L,xSampling:_,ySampling:U})}return f.value+=1,M}function On(i,l){var f=me(i,l),C=me(i,l),E=me(i,l),M=me(i,l),w=me(i,l),G=me(i,l),L=me(i,l),_=me(i,l);return{redX:f,redY:C,greenX:E,greenY:M,blueX:w,blueY:G,whiteX:L,whiteY:_}}function Jn(i,l){var f=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],C=it(i,l);return f[C]}function Pn(i,l){var f=Me(i,l),C=Me(i,l),E=Me(i,l),M=Me(i,l);return{xMin:f,yMin:C,xMax:E,yMax:M}}function Nn(i,l){var f=["INCREASING_Y"],C=it(i,l);return f[C]}function kn(i,l){var f=me(i,l),C=me(i,l);return[f,C]}function Kn(i,l){var f=me(i,l),C=me(i,l),E=me(i,l);return[f,C,E]}function Qn(i,l,f,C,E){if(C==="string"||C==="stringvector"||C==="iccProfile")return xn(l,f,E);if(C==="chlist")return Un(i,l,f,E);if(C==="chromaticities")return On(i,f);if(C==="compression")return Jn(i,f);if(C==="box2i")return Pn(i,f);if(C==="lineOrder")return Nn(i,f);if(C==="float")return me(i,f);if(C==="v2f")return kn(i,f);if(C==="v3f")return Kn(i,f);if(C==="int")return Bt(i,f);if(C==="rational")return Sn(i,f);if(C==="timecode")return Hn(i,f);if(C==="preview")return f.value+=E,"skipped";f.value+=E}function Xn(i,l,f){const C={};if(i.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";C.version=i.getUint8(4);const E=i.getUint8(5);C.spec={singleTile:!!(E&2),longName:!!(E&4),deepFormat:!!(E&8),multiPart:!!(E&16)},f.value=8;for(var M=!0;M;){var w=yt(l,f);if(w==0)M=!1;else{var G=yt(l,f),L=Me(i,f),_=Qn(i,l,f,G,L);_===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${G}'.`):C[w]=_}}if(E&-5)throw console.error("EXRHeader:",C),"THREE.EXRLoader: provided file is currently unsupported.";return C}function Zn(i,l,f,C,E){const M={size:0,viewer:l,array:f,offset:C,width:i.dataWindow.xMax-i.dataWindow.xMin+1,height:i.dataWindow.yMax-i.dataWindow.yMin+1,channels:i.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:i.channels[0].pixelType,uncompress:null,getter:null,format:null,[vt?"colorSpace":"encoding"]:null};switch(i.compression){case"NO_COMPRESSION":M.lines=1,M.uncompress=vr;break;case"RLE_COMPRESSION":M.lines=1,M.uncompress=yn;break;case"ZIPS_COMPRESSION":M.lines=1,M.uncompress=Jt;break;case"ZIP_COMPRESSION":M.lines=16,M.uncompress=Jt;break;case"PIZ_COMPRESSION":M.lines=32,M.uncompress=bn;break;case"PXR24_COMPRESSION":M.lines=16,M.uncompress=wn;break;case"DWAA_COMPRESSION":M.lines=32,M.uncompress=Er;break;case"DWAB_COMPRESSION":M.lines=256,M.uncompress=Er;break;default:throw"EXRLoader.parse: "+i.compression+" is unsupported"}if(M.scanlineBlockSize=M.lines,M.type==1)switch(E){case Ze:M.getter=Ln,M.inputSize=2;break;case Ie:M.getter=ft,M.inputSize=2;break}else if(M.type==2)switch(E){case Ze:M.getter=me,M.inputSize=4;break;case Ie:M.getter=_n,M.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+M.type+" for "+i.compression+".";M.blockCount=(i.dataWindow.yMax+1)/M.scanlineBlockSize;for(var w=0;w<M.blockCount;w++)De(l,C);M.outputChannels=M.channels==3?4:M.channels;const G=M.width*M.height*M.outputChannels;switch(E){case Ze:M.byteArray=new Float32Array(G),M.channels<M.outputChannels&&M.byteArray.fill(1,0,G);break;case Ie:M.byteArray=new Uint16Array(G),M.channels<M.outputChannels&&M.byteArray.fill(15360,0,G);break;default:console.error("THREE.EXRLoader: unsupported type: ",E);break}return M.bytesPerLine=M.width*M.inputSize*M.channels,M.outputChannels==4?M.format=Tt:M.format=Rs,vt?M.colorSpace="srgb-linear":M.encoding=3e3,M}const bt=new DataView(e),jn=new Uint8Array(e),mt={value:0},pt=Xn(bt,e,mt),z=Zn(pt,bt,jn,mt,this.type),Fr={value:0},Yn={R:0,G:1,B:2,A:3,Y:0};for(let i=0;i<z.height/z.scanlineBlockSize;i++){const l=Me(bt,mt);z.size=Me(bt,mt),z.lines=l+z.scanlineBlockSize>z.height?z.height-l:z.scanlineBlockSize;const C=z.size<z.lines*z.bytesPerLine?z.uncompress(z):vr(z);mt.value+=z.size;for(let E=0;E<z.scanlineBlockSize;E++){const M=E+i*z.scanlineBlockSize;if(M>=z.height)break;for(let w=0;w<z.channels;w++){const G=Yn[pt.channels[w].name];for(let L=0;L<z.width;L++){Fr.value=(E*(z.channels*z.width)+w*z.width+L)*z.inputSize;const _=(z.height-1-M)*(z.width*z.outputChannels)+L*z.outputChannels+G;z.byteArray[_]=z.getter(C,Fr)}}}}return{header:pt,width:z.width,height:z.height,data:z.byteArray,format:z.format,[vt?"colorSpace":"encoding"]:z[vt?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(a,u){vt?a.colorSpace=u.colorSpace:a.encoding=u.encoding,a.minFilter=Se,a.magFilter=Se,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,u)}return super.load(e,s,n,r)}}const jt=new WeakMap;class Qa extends ir{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new et(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{const u={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,u).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const o in t.attributeTypes){const c=t.attributeTypes[o];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[o]=c.name)}const n=JSON.stringify(t);if(jt.has(e)){const o=jt.get(e);if(o.key===n)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=e.byteLength,u=this._getWorker(s,a).then(o=>(r=o,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return u.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),jt.set(e,{key:n,promise:u}),u}_createGeometry(e){const t=new kr;e.index&&t.setIndex(new Mt(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,a=r.array,u=r.itemSize;t.setAttribute(s,new Mt(a,u))}return t}_loadLibrary(e,t){const n=new et(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=Xa.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Xa(){let A,e;onmessage=function(a){const u=a.data;switch(u.type){case"init":A=u.decoderConfig,e=new Promise(function(h){A.onModuleLoaded=function(d){h({draco:d})},DracoDecoderModule(A)});break;case"decode":const o=u.buffer,c=u.taskConfig;e.then(h=>{const d=h.draco,B=new d.Decoder,m=new d.DecoderBuffer;m.Init(new Int8Array(o),o.byteLength);try{const g=t(d,B,m,c),p=g.attributes.map(v=>v.array.buffer);g.index&&p.push(g.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:g},p)}catch(g){console.error(g),self.postMessage({type:"error",id:u.id,error:g.message})}finally{d.destroy(m),d.destroy(B)}});break}};function t(a,u,o,c){const h=c.attributeIDs,d=c.attributeTypes;let B,m;const g=u.GetEncodedGeometryType(o);if(g===a.TRIANGULAR_MESH)B=new a.Mesh,m=u.DecodeBufferToMesh(o,B);else if(g===a.POINT_CLOUD)B=new a.PointCloud,m=u.DecodeBufferToPointCloud(o,B);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||B.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const p={index:null,attributes:[]};for(const v in h){const F=self[d[v]];let R,O;if(c.useUniqueIDs)O=h[v],R=u.GetAttributeByUniqueId(B,O);else{if(O=u.GetAttributeId(B,a[h[v]]),O===-1)continue;R=u.GetAttribute(B,O)}p.attributes.push(r(a,u,B,v,F,R))}return g===a.TRIANGULAR_MESH&&(p.index=n(a,u,B)),a.destroy(B),p}function n(a,u,o){const h=o.num_faces()*3,d=h*4,B=a._malloc(d);u.GetTrianglesUInt32Array(o,d,B);const m=new Uint32Array(a.HEAPF32.buffer,B,h).slice();return a._free(B),{array:m,itemSize:1}}function r(a,u,o,c,h,d){const B=d.num_components(),g=o.num_points()*B,p=g*h.BYTES_PER_ELEMENT,v=s(a,h),F=a._malloc(p);u.GetAttributeDataArrayForAllPoints(o,d,v,p,F);const R=new h(a.HEAPF32.buffer,F,g).slice();return a._free(F),{name:c,array:R,itemSize:B}}function s(a,u){switch(u){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let xt;const Yt=()=>{if(xt)return xt;const A="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",e="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",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=A;WebAssembly.validate(t)&&(r=e);let s;const a=WebAssembly.instantiate(u(r),{}).then(d=>{s=d.instance,s.exports.__wasm_call_ctors()});function u(d){const B=new Uint8Array(d.length);for(let g=0;g<d.length;++g){const p=d.charCodeAt(g);B[g]=p>96?p-71:p>64?p-65:p>47?p+4:p>46?63:62}let m=0;for(let g=0;g<d.length;++g)B[m++]=B[g]<60?n[B[g]]:(B[g]-60)*64+B[++g];return B.buffer.slice(0,m)}function o(d,B,m,g,p,v){const F=s.exports.sbrk,R=m+3&-4,O=F(R*g),x=F(p.length),y=new Uint8Array(s.exports.memory.buffer);y.set(p,x);const I=d(O,m,g,x,p.length);if(I===0&&v&&v(O,R,g),B.set(y.subarray(O,O+m*g)),F(O-F(0)),I!==0)throw new Error(`Malformed buffer data: ${I}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return xt={ready:a,supported:!0,decodeVertexBuffer(d,B,m,g,p){o(s.exports.meshopt_decodeVertexBuffer,d,B,m,g,s.exports[c[p]])},decodeIndexBuffer(d,B,m,g){o(s.exports.meshopt_decodeIndexBuffer,d,B,m,g)},decodeIndexSequence(d,B,m,g){o(s.exports.meshopt_decodeIndexSequence,d,B,m,g)},decodeGltfBuffer(d,B,m,g,p,v){o(s.exports[h[p]],d,B,m,g,s.exports[c[v]])}},xt};function nn(A,e,t,n){const r=class extends At{constructor(a={}){const u=Object.entries(A);super({uniforms:u.reduce((o,[c,h])=>{const d=Ts.clone({[c]:{value:h}});return{...o,...d}},{}),vertexShader:e,fragmentShader:t}),this.key="",u.forEach(([o])=>Object.defineProperty(this,o,{get:()=>this.uniforms[o].value,set:c=>this.uniforms[o].value=c})),Object.assign(this,a)}};return r.key=Ft.generateUUID(),r}const Za=()=>parseInt(ar.replace(/\D+/g,"")),sn=Za();let St=null,an="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function on(A,e,t){return n=>{t&&t(n),A&&(St||(St=new Qa),St.setDecoderPath(typeof A=="string"?A:an),n.setDRACOLoader(St)),e&&n.setMeshoptDecoder(typeof Yt=="function"?Yt():Yt)}}function Ye(A,e=!0,t=!0,n){return Ut(Ar,A,on(e,t,n))}Ye.preload=(A,e=!0,t=!0,n)=>Ut.preload(Ar,A,on(e,t,n));Ye.clear=A=>Ut.clear(Ar,A);Ye.setDecoderPath=A=>{an=A};const ja=D.forwardRef(function({children:e,disable:t,disableX:n,disableY:r,disableZ:s,left:a,right:u,top:o,bottom:c,front:h,back:d,onCentered:B,precise:m=!0,cacheKey:g=0,...p},v){const F=D.useRef(null),R=D.useRef(null),O=D.useRef(null);return D.useLayoutEffect(()=>{R.current.matrixWorld.identity();const x=new or().setFromObject(O.current,m),y=new ee,I=new Xr,S=x.max.x-x.min.x,T=x.max.y-x.min.y,b=x.max.z-x.min.z;x.getCenter(y),x.getBoundingSphere(I);const k=o?T/2:c?-T/2:0,j=a?-S/2:u?S/2:0,Q=h?b/2:d?-b/2:0;R.current.position.set(t||n?0:-y.x+j,t||r?0:-y.y+k,t||s?0:-y.z+Q),typeof B<"u"&&B({parent:F.current.parent,container:F.current,width:S,height:T,depth:b,boundingBox:x,boundingSphere:I,center:y,verticalAlignment:k,horizontalAlignment:j,depthAlignment:Q})},[g,B,o,a,h,t,n,r,s,m,u,c,d]),D.useImperativeHandle(v,()=>F.current,[]),D.createElement("group",qe({ref:F},p),D.createElement("group",{ref:R},D.createElement("group",{ref:O},e)))}),Ya=3e3,Wa=3001,Va=nn({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");var be=function(A){return A[A.NONE=0]="NONE",A[A.START=1]="START",A[A.ACTIVE=2]="ACTIVE",A}(be||{});const ot=A=>A&&A.isOrthographicCamera,za=A=>A&&A.isBox3,qa=A=>1-Math.exp(-5*A)+.007*A,cn=D.createContext(null);function $a({children:A,maxDuration:e=1,margin:t=1.2,observe:n,fit:r,clip:s,interpolateFunc:a=qa,onFit:u}){const o=D.useRef(null),{camera:c,size:h,invalidate:d}=Re(),B=Re(y=>y.controls),m=D.useRef(u);m.current=u;const g=D.useRef({camPos:new ee,camRot:new It,camZoom:1}),p=D.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),v=D.useRef(be.NONE),F=D.useRef(0),[R]=D.useState(()=>new or),O=D.useMemo(()=>{function y(){const I=R.getSize(new ee),S=R.getCenter(new ee),T=Math.max(I.x,I.y,I.z),b=ot(c)?T*4:T/(2*Math.atan(Math.PI*c.fov/360)),k=ot(c)?T*4:b/c.aspect,j=t*Math.max(b,k);return{box:R,size:I,center:S,distance:j}}return{getSize:y,refresh(I){if(za(I))R.copy(I);else{const S=I||o.current;if(!S)return this;S.updateWorldMatrix(!0,!0),R.setFromObject(S)}if(R.isEmpty()){const S=c.position.length()||10;R.setFromCenterAndSize(new ee,new ee(S,S,S))}return g.current.camPos.copy(c.position),g.current.camRot.copy(c.quaternion),ot(c)&&(g.current.camZoom=c.zoom),p.current.camPos=void 0,p.current.camRot=void 0,p.current.camZoom=void 0,p.current.camUp=void 0,p.current.target=void 0,this},reset(){const{center:I,distance:S}=y(),T=c.position.clone().sub(I).normalize();p.current.camPos=I.clone().addScaledVector(T,S),p.current.target=I.clone();const b=new st().lookAt(p.current.camPos,p.current.target,c.up);return p.current.camRot=new It().setFromRotationMatrix(b),v.current=be.START,F.current=0,this},moveTo(I){return p.current.camPos=Array.isArray(I)?new ee(...I):I.clone(),v.current=be.START,F.current=0,this},lookAt({target:I,up:S}){p.current.target=Array.isArray(I)?new ee(...I):I.clone(),S?p.current.camUp=Array.isArray(S)?new ee(...S):S.clone():p.current.camUp=c.up.clone();const T=new st().lookAt(p.current.camPos||c.position,p.current.target,p.current.camUp);return p.current.camRot=new It().setFromRotationMatrix(T),v.current=be.START,F.current=0,this},to({position:I,target:S}){return this.moveTo(I).lookAt({target:S})},fit(){if(!ot(c))return this.reset();let I=0,S=0;const T=[new ee(R.min.x,R.min.y,R.min.z),new ee(R.min.x,R.max.y,R.min.z),new ee(R.min.x,R.min.y,R.max.z),new ee(R.min.x,R.max.y,R.max.z),new ee(R.max.x,R.max.y,R.max.z),new ee(R.max.x,R.max.y,R.min.z),new ee(R.max.x,R.min.y,R.max.z),new ee(R.max.x,R.min.y,R.min.z)],b=p.current.camPos||c.position,k=p.current.target||(B==null?void 0:B.target),j=p.current.camUp||c.up,Q=k?new st().lookAt(b,k,j).setPosition(b).invert():c.matrixWorldInverse;for(const q of T)q.applyMatrix4(Q),I=Math.max(I,Math.abs(q.y)),S=Math.max(S,Math.abs(q.x));I*=2,S*=2;const Y=(c.top-c.bottom)/I,P=(c.right-c.left)/S;return p.current.camZoom=Math.min(Y,P)/t,v.current=be.START,F.current=0,m.current&&m.current(this.getSize()),this},clip(){const{distance:I}=y();return c.near=I/100,c.far=I*100,c.updateProjectionMatrix(),B&&(B.maxDistance=I*10,B.update()),d(),this}}},[R,c,B,t,d]);D.useLayoutEffect(()=>{if(B){const y=()=>{if(B&&p.current.target&&v.current!==be.NONE){const I=new ee().setFromMatrixColumn(c.matrix,2),S=g.current.camPos.distanceTo(B.target),T=(p.current.camPos||g.current.camPos).distanceTo(p.current.target),b=(1-F.current)*S+F.current*T;B.target.copy(c.position).addScaledVector(I,-b),B.update()}v.current=be.NONE};return B.addEventListener("start",y),()=>B.removeEventListener("start",y)}},[B]);const x=D.useRef(0);return D.useLayoutEffect(()=>{(n||x.current++===0)&&(O.refresh(),r&&O.reset().fit(),s&&O.clip())},[h,s,r,n,c,B]),Ot((y,I)=>{if(v.current===be.START)v.current=be.ACTIVE,d();else if(v.current===be.ACTIVE){if(F.current+=I/e,F.current>=1)p.current.camPos&&c.position.copy(p.current.camPos),p.current.camRot&&c.quaternion.copy(p.current.camRot),p.current.camUp&&c.up.copy(p.current.camUp),p.current.camZoom&&ot(c)&&(c.zoom=p.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix(),B&&p.current.target&&(B.target.copy(p.current.target),B.update()),v.current=be.NONE;else{const S=a(F.current);p.current.camPos&&c.position.lerpVectors(g.current.camPos,p.current.camPos,S),p.current.camRot&&c.quaternion.slerpQuaternions(g.current.camRot,p.current.camRot,S),p.current.camUp&&c.up.set(0,1,0).applyQuaternion(c.quaternion),p.current.camZoom&&ot(c)&&(c.zoom=(1-S)*g.current.camZoom+S*p.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix()}d()}}),D.createElement("group",{ref:o},D.createElement(cn.Provider,{value:O},A))}function ei(){return D.useContext(cn)}const ln=(A,e,t)=>{let n;switch(A){case er:n=new Uint8ClampedArray(e*t*4);break;case Ie:n=new Uint16Array(e*t*4);break;case xs:n=new Uint32Array(e*t*4);break;case ws:n=new Int8Array(e*t*4);break;case bs:n=new Int16Array(e*t*4);break;case ys:n=new Int32Array(e*t*4);break;case Ze:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let Ht;const ti=(A,e,t,n)=>{if(Ht!==void 0)return Ht;const r=new ht(1,1,n);e.setRenderTarget(r);const s=new Dt(new cr,new ct({color:16777215}));e.render(s,t),e.setRenderTarget(null);const a=ln(A,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),Ht=a[0]!==0,Ht};class hr{constructor(e){var t,n,r,s,a,u,o,c,h,d,B,m,g,p,v,F;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(O){throw this._renderer.setRenderTarget(null),O}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const R={format:Tt,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy)!==void 0?(n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(u=e.renderTargetOptions)===null||u===void 0?void 0:u.magFilter:Se,minFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:Se,samples:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.samples)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples:void 0,wrapS:((B=e.renderTargetOptions)===null||B===void 0?void 0:B.wrapS)!==void 0?(m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapS:Qe,wrapT:((g=e.renderTargetOptions)===null||g===void 0?void 0:g.wrapT)!==void 0?(p=e.renderTargetOptions)===null||p===void 0?void 0:p.wrapT:Qe};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=hr.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new jr,this._camera=new Kr,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!ti(this._type,this._renderer,this._camera,R)){let O;switch(this._type){case Ie:O=this._renderer.extensions.has("EXT_color_buffer_float")?Ze:void 0;break}O!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ze}`),this._type=O):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Dt(new cr,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ht(this.width,this.height,R),this._renderTarget.texture.mapping=((v=e.renderTargetOptions)===null||v===void 0?void 0:v.mapping)!==void 0?(F=e.renderTargetOptions)===null||F===void 0?void 0:F.mapping:Lt}static instantiateRenderer(){const e=new Ds;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=ln(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Gs(this.toArray(),this.width,this.height,Tt,this._type,(e==null?void 0:e.mapping)||Lt,(e==null?void 0:e.wrapS)||Qe,(e==null?void 0:e.wrapT)||Qe,(e==null?void 0:e.magFilter)||Se,(e==null?void 0:e.minFilter)||Se,(e==null?void 0:e.anisotropy)||1,$t);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof At&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Xe&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Xe&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const ri=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,ni=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class si extends At{constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:u,hdrCapacityMax:o,sdr:c,gainMap:h}){super({name:"GainMapDecoderMaterial",vertexShader:ri,fragmentShader:ni,uniforms:{sdr:{value:c},gainMap:{value:h},gamma:{value:new ee(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ee().fromArray(t)},offsetSdr:{value:new ee().fromArray(n)},gainMapMin:{value:new ee().fromArray(r)},gainMapMax:{value:new ee().fromArray(s)},weightFactor:{value:(Math.log2(a)-u)/(o-u)}},blending:_s,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=u,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class un extends Error{}class An extends Error{}const Et=(A,e,t)=>{var n;let r;const s=(n=A.attributes.getNamedItem(e))===null||n===void 0?void 0:n.nodeValue;if(s)r=s;else{const a=A.getElementsByTagName(e)[0];if(a){const u=a.getElementsByTagName("rdf:li");if(u.length===3)r=Array.from(u).map(o=>o.innerHTML);else throw new Error(`Gainmap metadata contains an array of items for ${e} but its length is not 3`)}else{if(t)return t;throw new Error(`Can't find ${e} in gainmap metadata`)}}return r},ai=A=>{var e,t;let n;typeof TextDecoder<"u"?n=new TextDecoder().decode(A):n=A.toString();let r=n.indexOf("<x:xmpmeta");const s=new DOMParser;for(;r!==-1;){const a=n.indexOf("x:xmpmeta>",r);n.slice(r,a+10);const u=n.slice(r,a+10);try{const c=s.parseFromString(u,"text/xml").getElementsByTagName("rdf:Description")[0],h=Et(c,"hdrgm:GainMapMin","0"),d=Et(c,"hdrgm:GainMapMax"),B=Et(c,"hdrgm:Gamma","1"),m=Et(c,"hdrgm:OffsetSDR","0.015625"),g=Et(c,"hdrgm:OffsetHDR","0.015625");let p=(e=c.attributes.getNamedItem("hdrgm:HDRCapacityMin"))===null||e===void 0?void 0:e.nodeValue;p||(p="0");const v=(t=c.attributes.getNamedItem("hdrgm:HDRCapacityMax"))===null||t===void 0?void 0:t.nodeValue;if(!v)throw new Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(h)?h.map(F=>parseFloat(F)):[parseFloat(h),parseFloat(h),parseFloat(h)],gainMapMax:Array.isArray(d)?d.map(F=>parseFloat(F)):[parseFloat(d),parseFloat(d),parseFloat(d)],gamma:Array.isArray(B)?B.map(F=>parseFloat(F)):[parseFloat(B),parseFloat(B),parseFloat(B)],offsetSdr:Array.isArray(m)?m.map(F=>parseFloat(F)):[parseFloat(m),parseFloat(m),parseFloat(m)],offsetHdr:Array.isArray(g)?g.map(F=>parseFloat(F)):[parseFloat(g),parseFloat(g),parseFloat(g)],hdrCapacityMin:parseFloat(p),hdrCapacityMax:parseFloat(v)}}catch{}r=n.indexOf("<x:xmpmeta",a)}};class ii{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const a=s.byteLength;let u=2,o=0,c;for(;u<a;){if(++o>250){n(new Error(`Found no marker after ${o} loops `));return}if(s.getUint8(u)!==255){n(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${s.getUint8(u).toString(16)}`));return}if(c=s.getUint8(u+1),r&&console.log(`Marker: ${c.toString(16)}`),c===226){r&&console.log("Found APP2 marker (0xffe2)");const h=u+4;if(s.getUint32(h)===1297106432){const d=h+4;let B;if(s.getUint16(d)===18761)B=!1;else if(s.getUint16(d)===19789)B=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(d+2,!B)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const m=s.getUint32(d+4,!B);if(m<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const g=d+m,p=s.getUint16(g,!B),v=g+2;let F=0;for(let y=v;y<v+12*p;y+=12)s.getUint16(y,!B)===45057&&(F=s.getUint32(y+8,!B));const O=g+2+p*12+4,x=[];for(let y=O;y<O+F*16;y+=16){const I={MPType:s.getUint32(y,!B),size:s.getUint32(y+4,!B),dataOffset:s.getUint32(y+8,!B),dependantImages:s.getUint32(y+12,!B),start:-1,end:-1,isFII:!1};I.dataOffset?(I.start=d+I.dataOffset,I.isFII=!1):(I.start=0,I.isFII=!0),I.end=I.start+I.size,x.push(I)}if(this.options.extractNonFII&&x.length){const y=new Blob([s]),I=[];for(const S of x){if(S.isFII&&!this.options.extractFII)continue;const T=y.slice(S.start,S.end+1,"image/jpeg");I.push(T)}t(I)}}}u+=2+s.getUint16(u+2)}})}}const oi=async A=>{const e=ai(A);if(!e)throw new An("Gain map XMP metadata not found");const n=await new ii({extractFII:!0,extractNonFII:!0}).extract(A);if(n.length!==2)throw new un("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},_r=A=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(A)});class hn extends ir{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new Ss}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new si({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Xe,sdr:new Xe});return new hr({width:16,height:16,type:Ie,colorSpace:$t,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,n,r){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([n],{type:"image/jpeg"});let u,o,c=!1;if(typeof createImageBitmap>"u"){const B=await Promise.all([s?_r(s):Promise.resolve(void 0),_r(a)]);o=B[0],u=B[1],c=!0}else{const B=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);o=B[0],u=B[1]}const h=new Xe(o||new ImageData(2,2),Lt,Qe,Qe,Se,Dr,Tt,er,1,$t);h.flipY=c,h.needsUpdate=!0;const d=new Xe(u,Lt,Qe,Qe,Se,Dr,Tt,er,1,Hs);d.flipY=c,d.needsUpdate=!0,e.width=u.width,e.height=u.height,e.material.gainMap=h,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class ci extends hn{load([e,t,n],r,s,a){const u=this.prepareQuadRenderer();let o,c,h;const d=async()=>{if(o&&c&&h){try{await this.render(u,h,o,c)}catch(b){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof a=="function"&&a(b),u.disposeOnDemandRenderer();return}typeof r=="function"&&r(u),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),u.disposeOnDemandRenderer()}};let B=!0,m=0,g=0,p=!0,v=0,F=0,R=!0,O=0,x=0;const y=()=>{if(typeof s=="function"){const b=m+v+O,k=g+F+x,j=B&&p&&R;s(new ProgressEvent("progress",{lengthComputable:j,loaded:k,total:b}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const I=new et(this._internalLoadingManager);I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(this.withCredentials),I.load(e,async b=>{if(typeof b=="string")throw new Error("Invalid sdr buffer");o=b,await d()},b=>{B=b.lengthComputable,g=b.loaded,m=b.total,y()},b=>{this.manager.itemError(e),typeof a=="function"&&a(b)});const S=new et(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(t,async b=>{if(typeof b=="string")throw new Error("Invalid gainmap buffer");c=b,await d()},b=>{p=b.lengthComputable,F=b.loaded,v=b.total,y()},b=>{this.manager.itemError(t),typeof a=="function"&&a(b)});const T=new et(this._internalLoadingManager);return T.setRequestHeader(this.requestHeader),T.setPath(this.path),T.setWithCredentials(this.withCredentials),T.load(n,async b=>{if(typeof b!="string")throw new Error("Invalid metadata string");h=JSON.parse(b),await d()},b=>{R=b.lengthComputable,x=b.loaded,O=b.total,y()},b=>{this.manager.itemError(n),typeof a=="function"&&a(b)}),u}}class li extends hn{load(e,t,n,r){const s=this.prepareQuadRenderer(),a=new et(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const o=new Uint8Array(u);let c,h,d;try{const B=await oi(o);c=B.sdr,h=B.gainMap,d=B.metadata}catch(B){if(B instanceof An||B instanceof un)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=o;else throw B}try{await this.render(s,d,c,h)}catch(B){this.manager.itemError(e),typeof r=="function"&&r(B),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,u=>{this.manager.itemError(e),typeof r=="function"&&r(u)}),s}}const Wt={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},ui="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",_t=A=>Array.isArray(A);function dn({files:A=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:e="",preset:t=void 0,encoding:n=void 0,extensions:r}={}){var s;let a=null,u=!1,o;if(t){if(!(t in Wt))throw new Error("Preset must be one of: "+Object.keys(Wt).join(", "));A=Wt[t],e=ui}const c=_t(A)&&A.length===6,h=_t(A)&&A.length===3&&A.some(v=>v.endsWith("json")),d=_t(A)?A[0]:A;if(u=_t(A),o=c?"cube":h?"webp":d.startsWith("data:application/exr")?"exr":d.startsWith("data:application/hdr")?"hdr":d.startsWith("data:image/jpeg")?"jpg":(s=d.split(".").pop())==null||(s=s.split("?"))==null||(s=s.shift())==null?void 0:s.toLowerCase(),a=o==="cube"?Os:o==="hdr"?ka:o==="exr"?Ka:o==="jpg"||o==="jpeg"?li:o==="webp"?ci:null,!a)throw new Error("useEnvironment: Unrecognized file extension: "+A);const B=Re(v=>v.gl),m=Ut(a,u?[A]:A,v=>{(o==="webp"||o==="jpg"||o==="jpeg")&&v.setRenderer(B),v.setPath==null||v.setPath(e),r&&r(v)});let g=u?m[0]:m;if(o==="jpg"||o==="jpeg"||o==="webp"){var p;g=(p=g.renderTarget)==null?void 0:p.texture}return g.mapping=c?Ls:Us,"colorSpace"in g?g.colorSpace=n??c?"srgb":"srgb-linear":g.encoding=n??c?Wa:Ya,g}const Ai=A=>A.current&&A.current.isScene,hi=A=>Ai(A)?A.current:A;function dr(A,e,t,n,r={}){var s,a,u,o,c;r={backgroundBlurriness:(s=r.blur)!==null&&s!==void 0?s:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const h=hi(e||t),d=h.background,B=h.environment,m={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(a=(u=h.backgroundRotation)==null||u.clone==null?void 0:u.clone())!==null&&a!==void 0?a:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(o=(c=h.environmentRotation)==null||c.clone==null?void 0:c.clone())!==null&&o!==void 0?o:[0,0,0]};return A!=="only"&&(h.environment=n),A&&(h.background=n),Gr(h,r),()=>{A!=="only"&&(h.environment=B),A&&(h.background=d),Gr(h,m)}}function Br({scene:A,background:e=!1,map:t,...n}){const r=Re(s=>s.scene);return D.useLayoutEffect(()=>{if(t)return dr(e,A,r,t,n)}),null}function Bn({background:A=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:u,...o}){const c=dn(o),h=Re(d=>d.scene);return D.useLayoutEffect(()=>dr(A,e,h,c,{blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:u})),null}function di({children:A,near:e=1,far:t=1e3,resolution:n=256,frames:r=1,map:s,background:a=!1,blur:u,backgroundBlurriness:o,backgroundIntensity:c,backgroundRotation:h,environmentIntensity:d,environmentRotation:B,scene:m,files:g,path:p,preset:v=void 0,extensions:F}){const R=Re(T=>T.gl),O=Re(T=>T.scene),x=D.useRef(null),[y]=D.useState(()=>new jr),I=D.useMemo(()=>{const T=new Js(n);return T.texture.type=Ie,T},[n]);D.useLayoutEffect(()=>(r===1&&x.current.update(R,y),dr(a,m,O,I.texture,{blur:u,backgroundBlurriness:o,backgroundIntensity:c,backgroundRotation:h,environmentIntensity:d,environmentRotation:B})),[A,y,I.texture,m,O,a,r,R]);let S=1;return Ot(()=>{(r===1/0||S<r)&&(x.current.update(R,y),S++)}),D.createElement(D.Fragment,null,Ps(D.createElement(D.Fragment,null,A,D.createElement("cubeCamera",{ref:x,args:[e,t,I]}),g||v?D.createElement(Bn,{background:!0,files:g,preset:v,path:p,extensions:F}):s?D.createElement(Br,{background:!0,map:s,extensions:F}):null),y))}function Bi(A){var e,t,n,r;const s=dn(A),a=A.map||s;D.useMemo(()=>Yr({GroundProjectedEnvImpl:sa}),[]);const u=D.useMemo(()=>[a],[a]),o=(e=A.ground)==null?void 0:e.height,c=(t=A.ground)==null?void 0:t.radius,h=(n=(r=A.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return D.createElement(D.Fragment,null,D.createElement(Br,qe({},A,{map:a})),D.createElement("groundProjectedEnvImpl",{args:u,scale:h,height:o,radius:c}))}function fi(A){return A.ground?D.createElement(Bi,A):A.map?D.createElement(Br,A):A.children?D.createElement(di,A):D.createElement(Bn,A)}const mi=D.forwardRef(({scale:A=10,frames:e=1/0,opacity:t=1,width:n=1,height:r=1,blur:s=1,near:a=0,far:u=10,resolution:o=512,smooth:c=!0,color:h="#000000",depthWrite:d=!1,renderOrder:B,...m},g)=>{const p=D.useRef(null),v=Re(P=>P.scene),F=Re(P=>P.gl),R=D.useRef(null);n=n*(Array.isArray(A)?A[0]:A||1),r=r*(Array.isArray(A)?A[1]:A||1);const[O,x,y,I,S,T,b]=D.useMemo(()=>{const P=new ht(o,o),q=new ht(o,o);q.texture.generateMipmaps=P.texture.generateMipmaps=!1;const X=new cr(n,r).rotateX(Math.PI/2),Ce=new Dt(X),Te=new Ns;Te.depthTest=Te.depthWrite=!1,Te.onBeforeCompile=ge=>{ge.uniforms={...ge.uniforms,ucolor:{value:new Ue(h)}},ge.fragmentShader=ge.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),ge.fragmentShader=ge.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Ee=new At(Pa),re=new At(Na);return re.depthTest=Ee.depthTest=!1,[P,X,Te,Ce,Ee,re,q]},[o,n,r,A,h]),k=P=>{I.visible=!0,I.material=S,S.uniforms.tDiffuse.value=O.texture,S.uniforms.h.value=P*1/256,F.setRenderTarget(b),F.render(I,R.current),I.material=T,T.uniforms.tDiffuse.value=b.texture,T.uniforms.v.value=P*1/256,F.setRenderTarget(O),F.render(I,R.current),I.visible=!1};let j=0,Q,Y;return Ot(()=>{R.current&&(e===1/0||j<e)&&(j++,Q=v.background,Y=v.overrideMaterial,p.current.visible=!1,v.background=null,v.overrideMaterial=y,F.setRenderTarget(O),F.render(v,R.current),k(s),c&&k(s*.4),F.setRenderTarget(null),p.current.visible=!0,v.overrideMaterial=Y,v.background=Q)}),D.useImperativeHandle(g,()=>p.current,[]),D.createElement("group",qe({"rotation-x":Math.PI/2},m,{ref:p}),D.createElement("mesh",{renderOrder:B,geometry:x,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},D.createElement("meshBasicMaterial",{transparent:!0,map:O.texture,opacity:t,depthWrite:d})),D.createElement("orthographicCamera",{ref:R,args:[-n/2,n/2,r/2,-r/2,a,u]}))});function pi(A){return A.isLight}function Ci(A){return!!A.geometry}const fn=D.createContext(null),gi=nn({color:new Ue,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <${sn>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),vi=D.forwardRef(({children:A,temporal:e,frames:t=40,limit:n=1/0,blend:r=20,scale:s=10,opacity:a=1,alphaTest:u=.75,color:o="black",colorBlend:c=2,resolution:h=1024,toneMapped:d=!0,...B},m)=>{Yr({SoftShadowMaterial:gi});const g=Re(I=>I.gl),p=Re(I=>I.scene),v=Re(I=>I.camera),F=Re(I=>I.invalidate),R=D.useRef(null),O=D.useRef(null),[x]=D.useState(()=>new Mi(g,p,h));D.useLayoutEffect(()=>{x.configure(R.current)},[]);const y=D.useMemo(()=>({lights:new Map,temporal:!!e,frames:Math.max(2,t),blend:Math.max(2,t===1/0?r:t),count:0,getMesh:()=>R.current,reset:()=>{x.clear();const I=R.current.material;I.opacity=0,I.alphaTest=0,y.count=0},update:(I=1)=>{const S=R.current.material;y.temporal?(S.opacity=Math.min(a,S.opacity+a/y.blend),S.alphaTest=Math.min(u,S.alphaTest+u/y.blend)):(S.opacity=a,S.alphaTest=u),O.current.visible=!0,x.prepare();for(let T=0;T<I;T++)y.lights.forEach(b=>b.update()),x.update(v,y.blend);O.current.visible=!1,x.finish()}}),[x,v,p,e,t,r,a,u]);return D.useLayoutEffect(()=>{y.reset(),!y.temporal&&y.frames!==1/0&&y.update(y.blend)}),D.useImperativeHandle(m,()=>y,[y]),Ot(()=>{(y.temporal||y.frames===1/0)&&y.count<y.frames&&y.count<n&&(F(),y.update(),y.count++)}),D.createElement("group",B,D.createElement("group",{traverse:()=>null,ref:O},D.createElement(fn.Provider,{value:y},A)),D.createElement("mesh",{receiveShadow:!0,ref:R,scale:s,rotation:[-Math.PI/2,0,0]},D.createElement("planeGeometry",null),D.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:d,color:o,blend:c,map:x.progressiveLightMap2.texture})))}),Ei=D.forwardRef(({castShadow:A=!0,bias:e=.001,mapSize:t=512,size:n=5,near:r=.5,far:s=500,frames:a=1,position:u=[0,0,0],radius:o=1,amount:c=8,intensity:h=sn>=155?Math.PI:1,ambient:d=.5,...B},m)=>{const g=D.useRef(null),p=new ee(...u).length(),v=D.useContext(fn),F=D.useCallback(()=>{let O;if(g.current)for(let x=0;x<g.current.children.length;x++)if(O=g.current.children[x],Math.random()>d)O.position.set(u[0]+Ft.randFloatSpread(o),u[1]+Ft.randFloatSpread(o),u[2]+Ft.randFloatSpread(o));else{let y=Math.acos(2*Math.random()-1)-Math.PI/2,I=2*Math.PI*Math.random();O.position.set(Math.cos(y)*Math.cos(I)*p,Math.abs(Math.cos(y)*Math.sin(I)*p),Math.sin(y)*p)}},[o,d,p,...u]),R=D.useMemo(()=>({update:F}),[F]);return D.useImperativeHandle(m,()=>R,[R]),D.useLayoutEffect(()=>{var O;const x=g.current;return v&&((O=v.lights)==null||O.set(x.uuid,R)),()=>{var y;return void(v==null||(y=v.lights)==null?void 0:y.delete(x.uuid))}},[v,R]),D.createElement("group",qe({ref:g},B),Array.from({length:c},(O,x)=>D.createElement("directionalLight",{key:x,castShadow:A,"shadow-bias":e,"shadow-mapSize":[t,t],intensity:h/c},D.createElement("orthographicCamera",{attach:"shadow-camera",args:[-n,n,n,-n,r,s]}))))});class Mi{constructor(e,t,n=1024){this.renderer=e,this.res=n,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new Ue,this.clearAlpha=0;const r={type:Ie,magFilter:qt,minFilter:qt};this.progressiveLightMap1=new ht(this.res,this.res,r),this.progressiveLightMap2=new ht(this.res,this.res,r),this.discardMat=new Va,this.targetMat=new ks({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=s=>{s.vertexShader=`varying vec2 vUv;
`+s.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const a=s.fragmentShader.indexOf("void main() {");s.fragmentShader=`varying vec2 vUv;
`+s.fragmentShader.slice(0,a)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+s.fragmentShader.slice(a-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,s.uniforms.previousShadowMap=this.previousShadowMap,s.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(e=>{Ci(e)?this.meshes.push({object:e,material:e.material}):pi(e)&&this.lights.push({object:e,intensity:e.intensity})})}prepare(){this.lights.forEach(e=>e.object.intensity=0),this.meshes.forEach(e=>e.object.material=this.discardMat)}finish(){this.lights.forEach(e=>e.object.intensity=e.intensity),this.meshes.forEach(e=>e.object.material=e.material)}configure(e){this.object=e}update(e,t=100){if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;const n=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,r=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,s=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(n),this.previousShadowMap.value=r.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=s}}const Fi={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function Ii({radius:A,adjustCamera:e}){const t=ei();return D.useEffect(()=>{e&&t.refresh().clip().fit()},[A,e]),null}function fr({children:A,center:e,adjustCamera:t=!0,intensity:n=.5,shadows:r="contact",environment:s="city",preset:a="rembrandt",...u}){var o,c,h,d,B,m,g,p;const v=typeof a=="string"?Fi[a]:a,[{radius:F,height:R},O]=D.useState({radius:0,width:0,height:0,depth:0}),x=(o=r==null?void 0:r.bias)!==null&&o!==void 0?o:-1e-4,y=(c=r==null?void 0:r.normalBias)!==null&&c!==void 0?c:0,I=(h=r==null?void 0:r.size)!==null&&h!==void 0?h:1024,S=(d=r==null?void 0:r.offset)!==null&&d!==void 0?d:0,T=r==="contact"||(r==null?void 0:r.type)==="contact",b=r==="accumulative"||(r==null?void 0:r.type)==="accumulative",k={...typeof r=="object"?r:{}},j=s?typeof s=="string"?{preset:s}:s:null,Q=D.useCallback(Y=>{const{width:P,height:q,depth:X,boundingSphere:Ce}=Y;O({radius:Ce.radius,width:P,height:q,depth:X}),e!=null&&e.onCentered&&e.onCentered(Y)},[]);return D.createElement(D.Fragment,null,D.createElement("ambientLight",{intensity:n/3}),D.createElement("spotLight",{penumbra:1,position:[v.main[0]*F,v.main[1]*F,v.main[2]*F],intensity:n*2,castShadow:!!r,"shadow-bias":x,"shadow-normalBias":y,"shadow-mapSize":I}),D.createElement("pointLight",{position:[v.fill[0]*F,v.fill[1]*F,v.fill[2]*F],intensity:n}),D.createElement($a,qe({fit:!!t,clip:!!t,margin:Number(t),observe:!0},u),D.createElement(Ii,{radius:F,adjustCamera:t}),D.createElement(ja,qe({},e,{position:[0,S/2,0],onCentered:Q}),A)),D.createElement("group",{position:[0,-R/2-S/2,0]},T&&D.createElement(mi,qe({scale:F*4,far:F,blur:2},k)),b&&D.createElement(vi,qe({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:F*4},k),D.createElement(Ei,{amount:(B=k.amount)!==null&&B!==void 0?B:8,radius:(m=k.radius)!==null&&m!==void 0?m:F,ambient:(g=k.ambient)!==null&&g!==void 0?g:.5,intensity:(p=k.intensity)!==null&&p!==void 0?p:1,position:[v.main[0]*F,v.main[1]*F,v.main[2]*F],size:F*4,bias:-x,mapSize:I}))),s&&D.createElement(fi,j))}const mn="/PortfolioWebsite/webDev-transformed.glb";function Ri(A){const{nodes:e,materials:t}=Ye(mn);return $.jsxs("group",{...A,dispose:null,children:[$.jsx("mesh",{geometry:e.Object_4.geometry,material:t.palette,rotation:[Math.PI/2,0,0]}),$.jsx("mesh",{geometry:e.Object_6.geometry,material:t["palette.001"],rotation:[Math.PI/2,0,0]}),$.jsx("mesh",{geometry:e.Object_8.geometry,material:t["palette.002"],rotation:[Math.PI/2,0,0]})]})}Ye.preload(mn);const Ti=at.div`
  width: 200px;
  height: 70px;
  padding: 20px;
  background-color: white;
  border-radius: 10px;
  position: absolute;
  top: 100px;
  right: 100px;

  @media only screen and (max-width: 760px) {
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
  }
`,Di=()=>$.jsxs($.Fragment,{children:[$.jsxs(lr,{children:[$.jsx(fr,{environment:"city",intensity:.6,children:$.jsx(Ri,{})}),$.jsx(ur,{enableZoom:!1,autoRotate:!0,autoRotateSpeed:.5})]}),$.jsx(Ti,{children:"Bringing ideas to life! Skilled animator with a passion for creating engaging visuals."})]}),pn="/PortfolioWebsite/reactLogo-transformed.glb";function Gi(A){const{nodes:e,materials:t}=Ye(pn);return $.jsx("group",{...A,dispose:null,children:$.jsx("mesh",{geometry:e["React-Logo_Material002_0"].geometry,material:t["Material.002"],position:[0,.079,.181],rotation:[0,0,-Math.PI/2],scale:[.392,.392,.527]})})}Ye.preload(pn);const yi=()=>$.jsxs(lr,{children:[$.jsx(fr,{environment:"city",intensity:.6,children:$.jsx(Gi,{})}),$.jsx(ur,{enableZoom:!1,autoRotate:!0,autoRotateSpeed:.5})]}),Cn="/PortfolioWebsite/Keyboard-transformed.glb";function bi(A){const{nodes:e,materials:t}=Ye(Cn);return $.jsxs("group",{...A,dispose:null,children:[$.jsx("mesh",{geometry:e.LP_keyboard_0.geometry,material:t.keyboard,rotation:[-Math.PI/2,0,0],scale:100}),$.jsx("mesh",{geometry:e.LP_outline_0.geometry,material:t.outline,rotation:[-Math.PI/2,0,0],scale:100})]})}Ye.preload(Cn);const wi=()=>$.jsxs(lr,{camera:{fov:25,position:[5,5,5]},children:[$.jsx(fr,{environment:"city",intensity:.6,children:$.jsx(bi,{scale:.5})}),$.jsx(ur,{enableZoom:!1,autoRotate:!0,autoRotateSpeed:.5})]}),xi=["Web Dev","3d Design","Animation"],Si=at.div`
  /* background-color: #244855; */
  background-color: #1a1c25;

  height: 100vh;
  scroll-snap-align: center;
  display: flex;
  justify-content: center;
  position: relative;
  color: black;
  font-size: 14px;
  font-weight: 300;
`,Hi=at.div`
  width: 1400px;
  display: flex;
  justify-content: space-between;

  @media only screen and (max-width: 760px) {
    width: 100%;
    flex-direction: column;
  }
  @media (min-width: 761px) and (max-width: 1024px) {
    width: 100%;
    flex-direction: column;
  }
`,_i=at.div`
  flex: 1;
  display: flex;
  align-items: center;
  @media only screen and (max-width: 760px) {
    padding: 10px;
    max-height: 30%;
    
  }
`,Li=at.ul`
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 20px;
`,Ui=at.li`
  font-size: 90px;
  font-weight: bold;
  cursor: pointer;
  color: transparent;
  -webkit-text-stroke: 1px white;
  position: relative;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
    Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;

  @media only screen and (max-width: 760px) {
    font-size: 24px;
    color: white;
    -webkit-text-stroke: 0px;
  }

  &:after {
    content: '${A=>A.text}';
    position: absolute;
    top: 0;
    left: 0;
    color: #75e2dd;
    /* color: #90aead; */
    width: 0px;
    overflow: hidden;
    white-space: nowrap;
  }

  &:hover {
    /* color:red; */
    &:after {
      animation: moveText 0.5s linear both;
      @keyframes moveText {
        to {
          width: 100%;
        }
      }
    }
  }
`,Oi=at.div`
  flex: 1;
  margin-top: 0px;

  /* position: relative; */
`,Ki=()=>{const[A,e]=D.useState("Web Dev");return $.jsx(Si,{id:"works",children:$.jsxs(Hi,{children:[$.jsx(_i,{children:$.jsx(Li,{children:xi.map(t=>$.jsx(Ui,{text:t,onClick:()=>e(t),children:t},t))})}),$.jsx(Oi,{children:A==="Web Dev"?$.jsx(yi,{}):A==="Animation"?$.jsx(Di,{}):$.jsx(wi,{})})]})})};export{Ki as default};
